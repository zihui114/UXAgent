"""
UX Analyzer with LLM - ä½¿ç”¨ LLM æ™ºèƒ½åˆ†ææ¸¬è©¦çµæœ

ä½¿ç”¨æ–¹å¼:
    python src/ux_analyzer_llm.py --run-dir runs/2026-01-01_20-14-18_3a5b --persona persona_cautious_verifier_nianjia.txt

    API Key æœƒè‡ªå‹•å¾ .env æª”æ¡ˆè®€å– OPENAI_API_KEY
"""

import json
import os
import argparse
from pathlib import Path
from typing import Dict, List, Any
from datetime import datetime
from dotenv import load_dotenv
import openai


class LLMUXAnalyzer:
    """ä½¿ç”¨ LLM é€²è¡Œæ™ºèƒ½ UX åˆ†æ"""

    def __init__(self, api_key: str = None):
        """
        åˆå§‹åŒ– LLM åˆ†æå™¨

        Args:
            api_key: OpenAI API keyï¼Œå¦‚æœä¸æä¾›å‰‡å¾ .env æª”æ¡ˆè®€å–
        """
        # è¼‰å…¥ .env æª”æ¡ˆ
        load_dotenv()

        self.api_key = api_key or os.environ.get('OPENAI_API_KEY')
        if not self.api_key:
            raise ValueError(
                "è«‹æä¾› OpenAI API key:\n"
                "1. åœ¨ .env æª”æ¡ˆä¸­è¨­å®š: OPENAI_API_KEY=your_key\n"
                "2. æˆ–ä½¿ç”¨ --api-key åƒæ•¸"
            )

        self.client = openai.OpenAI(api_key=self.api_key)

    def analyze_test_results(
        self,
        memory_trace: List[Dict],
        action_trace: List[str],
        persona_text: str,
        persona_info: Dict,
        persona_file: str = None,
        run_dir: str = None
    ) -> Dict[str, Any]:
        """
        ä½¿ç”¨ LLM åˆ†ææ¸¬è©¦çµæœ

        Args:
            memory_trace: å®Œæ•´çš„ memory_trace.json æ•¸æ“š
            action_trace: å‹•ä½œåºåˆ—
            persona_text: persona æª”æ¡ˆåŸæ–‡
            persona_info: persona åŸºæœ¬è³‡è¨Š
            persona_file: persona æª”æ¡ˆåç¨± (é¸å¡«)
            run_dir: æ¸¬è©¦ç›®éŒ„åç¨± (é¸å¡«)

        Returns:
            çµæ§‹åŒ–çš„ UX åˆ†æçµæœ
        """
        # æº–å‚™æ•¸æ“šçµ¦ LLM
        analysis_data = self._prepare_analysis_data(
            memory_trace, action_trace, persona_text, persona_info
        )

        # å‘¼å« LLM
        print("ğŸ¤– æ­£åœ¨ä½¿ç”¨ GPT-4 åˆ†ææ¸¬è©¦çµæœ...")

        try:
            response = self.client.chat.completions.create(
                model="gpt-4o",  # ä½¿ç”¨æœ€æ–°çš„ GPT-4o æ¨¡å‹
                messages=[
                    {
                        "role": "system",
                        "content": "ä½ æ˜¯ä¸€ä½è³‡æ·±çš„ UX ç ”ç©¶å°ˆå®¶ï¼Œå°ˆé–€åˆ†æä½¿ç”¨è€…æ¸¬è©¦çµæœã€‚ä½ æœƒä»”ç´°åˆ†ææ¸¬è©¦æ•¸æ“šï¼Œæ‰¾å‡ºæ‰€æœ‰ UX å•é¡Œä¸¦æä¾›å¯åŸ·è¡Œçš„æ”¹å–„å»ºè­°ã€‚ä½ å¿…é ˆåš´æ ¼éµå¾ªæŒ‡ç¤ºï¼Œç¢ºä¿åˆ†æçš„æº–ç¢ºæ€§å’Œå®Œæ•´æ€§ã€‚"
                    },
                    {
                        "role": "user",
                        "content": self._build_analysis_prompt(analysis_data)
                    }
                ],
                temperature=0.1,  # é€²ä¸€æ­¥é™ä½temperatureè®“å›æ‡‰æ›´æº–ç¢º
                max_completion_tokens=12000,  # å¢åŠ åˆ°12000è®“LLMæœ‰è¶³å¤ ç©ºé–“è¼¸å‡ºè©³ç´°åˆ†æ
                response_format={"type": "json_object"}  # å¼·åˆ¶ JSON è¼¸å‡º
            )

            # è§£æ LLM å›æ‡‰
            analysis_result = self._parse_llm_response(response.choices[0].message.content)

            # æ·»åŠ æ¸¬è©¦å…ƒæ•¸æ“šåˆ°çµæœçš„é–‹é ­ (è¦†è“‹ LLM å¯èƒ½ç”Ÿæˆçš„ç¤ºä¾‹æ•¸æ“š)
            test_metadata = {
                "persona_file": persona_file or "Unknown",
                "persona_name": persona_info.get('name', 'Unknown'),
                "persona_type": persona_info.get('type', 'Unknown'),
                "risk_perception": persona_info.get('risk_perception', 'Unknown'),
                "self_efficacy": persona_info.get('self_efficacy', 'Unknown'),
                "working_memory": persona_info.get('working_memory', 'Unknown'),
                "strategy": persona_info.get('strategy', 'Unknown'),
                "run_directory": run_dir or "Unknown",
                "analysis_timestamp": datetime.now().isoformat(),
                "total_actions": analysis_data.get('total_actions', 0),
                "total_thoughts": analysis_data.get('total_thoughts', 0),
                "total_reflections": analysis_data.get('total_reflections', 0)
            }

            # å…ˆå‰µå»ºçµæœå­—å…¸ï¼Œç„¶å¾Œç”¨çœŸå¯¦çš„ test_metadata è¦†è“‹ LLM ç”Ÿæˆçš„ç¤ºä¾‹æ•¸æ“š
            result_with_metadata = {"test_metadata": test_metadata}
            # ç§»é™¤ LLM çµæœä¸­å¯èƒ½å­˜åœ¨çš„ test_metadata (å¦‚æœæœ‰çš„è©±)
            if 'test_metadata' in analysis_result:
                del analysis_result['test_metadata']
            result_with_metadata.update(analysis_result)

        except openai.RateLimitError:
            print("âŒ API é…é¡å·²ç”¨ç›¡æˆ–é”åˆ°é€Ÿç‡é™åˆ¶")
            raise
        except openai.APIError as e:
            print(f"âŒ OpenAI API éŒ¯èª¤: {e}")
            raise

        return result_with_metadata

    def _prepare_analysis_data(
        self,
        memory_trace: List[Dict],
        action_trace: List[str],
        persona_text: str,
        persona_info: Dict
    ) -> Dict[str, Any]:
        """æº–å‚™çµ¦ LLM çš„åˆ†ææ•¸æ“š"""

        # æå–é—œéµæ€è€ƒï¼ˆä¸­æ–‡ thoughtsï¼‰
        chinese_thoughts = []
        english_reflections = []

        for entry in memory_trace:
            if entry.get('kind') == 'thought':
                content = entry.get('content', '')
                # æª¢æŸ¥æ˜¯å¦åŒ…å«ä¸­æ–‡å­—ç¬¦
                if any('\u4e00' <= char <= '\u9fff' for char in content):
                    chinese_thoughts.append({
                        'timestamp': entry.get('timestamp', 0),
                        'content': content
                    })
            elif entry.get('kind') == 'reflection':
                english_reflections.append({
                    'timestamp': entry.get('timestamp', 0),
                    'content': entry.get('content', '')[:300]  # é™åˆ¶é•·åº¦
                })

        # è§£æå‹•ä½œåºåˆ—ï¼ˆæ”¯æ´æ–°èˆŠå…©ç¨®æ ¼å¼ï¼‰
        actions = []
        element_info_map = {}  # å„²å­˜å…ƒç´ çš„ class/id è³‡è¨Š
        for action_str in action_trace:
            try:
                action = json.loads(action_str)
                # æ–°æ ¼å¼ï¼šåŒ…å« action å’Œ element_info
                if isinstance(action, dict) and "action" in action:
                    actual_action = action["action"]
                    element_info = action.get("element_info", {})
                    target_id = actual_action.get("target", "")
                    if target_id and element_info:
                        element_info_map[target_id] = element_info
                    actions.append(actual_action)
                else:
                    # èˆŠæ ¼å¼ï¼šç›´æ¥æ˜¯ action
                    actions.append(action)
            except:
                pass

        # åˆ†æé‡è¤‡å‹•ä½œæ¨¡å¼
        action_frequency = {}
        for action in actions:
            # æå– target å’Œ description
            target = action.get('target', '')
            desc = action.get('description', '')

            # å»ºç«‹å”¯ä¸€éµï¼ˆåŸºæ–¼ description çš„é—œéµå­—ï¼‰
            key_words = []
            for keyword in ['å“ç‰Œå…¬å‘Š', 'å“ç‰Œæ•…äº‹', 'å•†å“è¦æ ¼', 'è©³ç´°èªªæ˜', 'åŠ å…¥è³¼ç‰©è»Š', 'è©•åƒ¹']:
                if keyword in desc:
                    key_words.append(keyword)

            if key_words:
                key = '+'.join(key_words)
                action_frequency[key] = action_frequency.get(key, 0) + 1

        return {
            'persona_info': persona_info,
            'persona_text_excerpt': persona_text[:1500],  # å¢åŠ åˆ°1500å­—ç¬¦
            'total_actions': len(actions),
            'actions': actions,
            'action_frequency': action_frequency,  # æ–°å¢ï¼šé‡è¤‡å‹•ä½œçµ±è¨ˆ
            'element_info_map': element_info_map,  # æ–°å¢ï¼šå…ƒç´ çš„ class/id è³‡è¨Š
            'chinese_thoughts': chinese_thoughts,  # ç§»é™¤é™åˆ¶ï¼Œæä¾›æ‰€æœ‰ä¸­æ–‡æ€è€ƒ
            'english_reflections': english_reflections[:50],  # å¢åŠ åˆ°50æ¢
            'total_thoughts': len(chinese_thoughts),
            'total_reflections': len(english_reflections)
        }

    def _build_analysis_prompt(self, data: Dict[str, Any]) -> str:
        """æ§‹å»ºçµ¦ LLM çš„åˆ†æ prompt"""

        prompt = f"""ä½ æ˜¯ä¸€ä½è³‡æ·±çš„ UX ç ”ç©¶å°ˆå®¶ã€‚è«‹å°ä»¥ä¸‹æ¸¬è©¦æ•¸æ“šé€²è¡Œ**æ·±åº¦åˆ†æ**ï¼Œæ‰¾å‡ºæ‰€æœ‰ UX å•é¡Œä¸¦æä¾›å¯åŸ·è¡Œçš„æ”¹å–„å»ºè­°ã€‚

# Persona è³‡è¨Š
- **å§“å**: {data['persona_info']['name']}
- **é¡å‹**: {data['persona_info']['type']}
- **é¢¨éšªæ„ŸçŸ¥**: {data['persona_info']['risk_perception']}
- **è‡ªæˆ‘æ•ˆèƒ½**: {data['persona_info']['self_efficacy']}
- **å·¥ä½œè¨˜æ†¶**: {data['persona_info']['working_memory']}
- **ä»»å‹™ç­–ç•¥**: {data['persona_info']['strategy']}

## Persona ç‰¹å¾µæè¿°
{data['persona_text_excerpt']}

# æ¸¬è©¦æ•¸æ“š

## å‹•ä½œåºåˆ—ï¼ˆå…± {data['total_actions']} å€‹å‹•ä½œï¼‰
{json.dumps(data['actions'], ensure_ascii=False, indent=2)}

## ğŸ”¥ é‡è¤‡å‹•ä½œçµ±è¨ˆï¼ˆé‡é»é—œæ³¨ï¼Œå¿…é ˆæº–ç¢ºå¼•ç”¨ï¼‰
{json.dumps(data['action_frequency'], ensure_ascii=False, indent=2)}

## ğŸ“ å…ƒç´ è³‡è¨Šæ˜ å°„ï¼ˆå¯¦éš›çš„ HTML class å’Œ idï¼‰
ä»¥ä¸‹æ˜¯æ¸¬è©¦éç¨‹ä¸­äº’å‹•å…ƒç´ çš„å¯¦éš› HTML è³‡è¨Šï¼Œ**åœ¨æ”¹å–„å»ºè­°ä¸­å¿…é ˆä½¿ç”¨é€™äº›å¯¦éš›çš„ class å’Œ id**ï¼š
{json.dumps(data.get('element_info_map', {}), ensure_ascii=False, indent=2)}

**åˆ†æè¦é»**ï¼š
- å¦‚æœæŸå€‹å‹•ä½œé‡è¤‡ â‰¥ 3 æ¬¡ï¼Œå¯èƒ½è¡¨ç¤º**é€£çµå¤±æ•ˆã€å›é¥‹ä¸è¶³æˆ–ä½¿ç”¨è€…å›°æƒ‘**
- å¦‚æœé»æ“Šã€Œå“ç‰Œå…¬å‘Šã€æˆ–ã€Œå“ç‰Œæ•…äº‹ã€å¤šæ¬¡ï¼Œå¯èƒ½è¡¨ç¤º**å°‹æ‰¾é©—è­‰è³‡è¨Šä½†æœªæ‰¾åˆ°**
- å¦‚æœé»æ“Šã€ŒåŠ å…¥è³¼ç‰©è»Šã€å¤šæ¬¡ï¼Œå¯èƒ½è¡¨ç¤º**ç¼ºä¹æˆåŠŸå›é¥‹**

## ä½¿ç”¨è€…å…§å¿ƒæƒ³æ³•ï¼ˆä¸­æ–‡æ€è€ƒï¼Œå…± {data['total_thoughts']} æ¢ï¼‰
**é€™æ˜¯æœ€é‡è¦çš„æ•¸æ“šï¼** é€™äº›æ˜¯ä½¿ç”¨è€…çš„çœŸå¯¦å…§å¿ƒç¨ç™½ï¼ŒåŒ…å«å›°æƒ‘ã€ç–‘æ…®ã€æ±ºç­–éç¨‹ï¼š

{json.dumps(data['chinese_thoughts'], ensure_ascii=False, indent=2)}

## ä½¿ç”¨è€…åæ€ï¼ˆè‹±æ–‡ï¼Œå…± {len(data['english_reflections'])} æ¢ï¼‰
{json.dumps(data['english_reflections'], ensure_ascii=False, indent=2)[:5000]}

---

# åˆ†æè¦æ±‚ï¼ˆåš´æ ¼éµå®ˆï¼‰

## æ­¥é©Ÿ 1ï¼šæ·±åº¦åˆ†æä½¿ç”¨è€…è¡Œç‚º

è«‹**é€æ¢é–±è®€**æ‰€æœ‰ä¸­æ–‡å…§å¿ƒæƒ³æ³•ï¼Œæ‰¾å‡ºï¼š
1. **é‡è¤‡å‡ºç¾çš„ç–‘æ…®**ï¼ˆä¾‹å¦‚ï¼šå¤šæ¬¡æåˆ°ã€Œå¥å­—è™Ÿã€ã€ã€ŒTFDAã€ã€ã€Œé©—è­‰ã€ï¼‰
2. **æœªè¢«æ»¿è¶³çš„éœ€æ±‚**ï¼ˆä¾‹å¦‚ï¼šæƒ³è¦çœ‹åˆ°ä½†æ²’çœ‹åˆ°çš„è³‡è¨Šï¼‰
3. **æ”¾æ£„çš„åŸå› **ï¼ˆå¦‚æœä»»å‹™æœªå®Œæˆï¼‰
4. **å¿ƒç†è®ŠåŒ–æ¼”é€²**ï¼ˆå¾åˆæœŸæ¢ç´¢ â†’ ç”¢ç”Ÿç–‘æ…® â†’ æŒ«æŠ˜ç´¯ç© â†’ æ”¾æ£„/å¦¥å”ï¼‰

## æ­¥é©Ÿ 2ï¼šè­˜åˆ¥æ‰€æœ‰ UX å•é¡Œï¼ˆå¼·åˆ¶è¦æ±‚ï¼‰

**åš´æ ¼è¦æ±‚**ï¼š
- âœ… å¿…é ˆæ‰¾å‡º **è‡³å°‘ 4 å€‹ç¨ç«‹çš„å…·é«” UX å•é¡Œ**ï¼ˆä¸æ˜¯ 1-2 å€‹æ³›åŒ–å•é¡Œï¼‰
- âœ… æ¯å€‹å•é¡Œéƒ½æ˜¯**ç¨ç«‹çš„ã€å…·é«”çš„**ï¼ˆä¾‹å¦‚ï¼šå•é¡Œ1æ˜¯ã€Œç¼ºä¹å¥å­—è™Ÿé€£çµã€ï¼Œå•é¡Œ2æ˜¯ã€Œå“ç‰Œå…¬å‘Šé€£çµå¤±æ•ˆã€ï¼Œå•é¡Œ3æ˜¯ã€Œç”¢å“è²ç¨±ç¼ºæ•¸æ“šã€ï¼‰
- âŒ ç¦æ­¢è¼¸å‡ºæ³›åŒ–å•é¡Œï¼ˆå¦‚ã€Œè³‡è¨Šåˆ†æ•£ã€è¦æ‹†è§£æˆï¼šç¼ºå°‘å“ªäº›å…·é«”è³‡è¨Šï¼Ÿï¼‰

æ¯å€‹å•é¡Œå¿…é ˆåŒ…å«ï¼ˆç¼ºä¸€ä¸å¯ï¼‰ï¼š
1. **å…·é«”çš„å•é¡Œæè¿°**
   - å¿…é ˆæ˜ç¢ºæŒ‡å‡ºç¼ºå°‘ä»€éº¼ï¼ˆä¾‹å¦‚ï¼šã€Œç¼ºä¹å¥å­—è™Ÿæ ¸å¯ç·¨è™Ÿã€è€Œä¸æ˜¯ã€Œè³‡è¨Šä¸è¶³ã€ï¼‰
   - å¿…é ˆåˆ—å‡ºå…·é«”çš„ç¼ºå¤±é …ç›®ï¼ˆä¾‹å¦‚ï¼šâŒ å¥å­—è™Ÿç·¨è™Ÿ âŒ TFDAé€£çµ âŒ è­‰æ›¸PDFï¼‰

2. **å¼•ç”¨è‡³å°‘ 5 æ¢ä½¿ç”¨è€…æƒ³æ³•**
   - å¿…é ˆå¼•ç”¨å®Œæ•´åŸæ–‡ï¼Œä¸å¯æ”¹å¯«
   - å¦‚æœé‡è¤‡é»æ“Šï¼Œéœ€å±•ç¤ºä¸åŒæ™‚é–“é»çš„æƒ³æ³•è®ŠåŒ–

3. **å¾ã€Œé‡è¤‡å‹•ä½œçµ±è¨ˆã€ä¸­æå–æº–ç¢ºæ¬¡æ•¸**
   - å¿…é ˆç›´æ¥å¼•ç”¨ action_frequency ä¸­çš„æ•¸å­—
   - æ ¼å¼ï¼šã€Œé»æ“Šã€å“ç‰Œå…¬å‘Šã€X æ¬¡ï¼ˆå¾é‡è¤‡å‹•ä½œçµ±è¨ˆå¾—å‡ºï¼‰ã€

4. **åš´é‡ç¨‹åº¦æº–ç¢ºåˆ¤æ–·**
   - CRITICAL: å°è‡´ä»»å‹™å®Œå…¨å¤±æ•—ï¼ˆä¾‹å¦‚ï¼šç„¡æ³•é©—è­‰è€Œæ”¾æ£„è³¼è²·ï¼‰
   - HIGH: åš´é‡å½±éŸ¿é«”é©—ï¼ˆä¾‹å¦‚ï¼šç”¢ç”Ÿå¼·çƒˆæ‡·ç–‘ï¼‰
   - MEDIUM: é€ æˆå›°æ“¾ï¼ˆä¾‹å¦‚ï¼šéœ€è¦é¡å¤–æœå°‹ï¼‰
   - LOW: è¼•å¾®å•é¡Œï¼ˆä¾‹å¦‚ï¼šUI å°ç‘•ç–µï¼‰

## æ­¥é©Ÿ 3ï¼šæ™‚é–“åºåˆ—åˆ†æï¼ˆæ–°å¢è¦æ±‚ï¼‰

é‡å°é‡è¤‡é»æ“Šæœ€å¤šçš„å‹•ä½œï¼ˆå¾ã€Œé‡è¤‡å‹•ä½œçµ±è¨ˆã€æ‰¾å‡ºï¼‰ï¼Œå¿…é ˆè¿½è¹¤ï¼š
1. ä½¿ç”¨è€…åœ¨ç¬¬ 1 æ¬¡é»æ“Šæ™‚çš„æƒ³æ³•
2. ä½¿ç”¨è€…åœ¨ä¸­é–“éšæ®µçš„æƒ³æ³•è®ŠåŒ–
3. ä½¿ç”¨è€…åœ¨æœ€å¾Œéšæ®µçš„æƒ³æ³•ï¼ˆæ˜¯å¦æ”¾æ£„ï¼Ÿï¼‰

ç¤ºä¾‹ï¼š
```
ç¬¬ 1 æ¬¡é»æ“Šï¼šã€Œæœƒä¸æœƒè—åœ¨å“ç‰Œå…¬å‘Šè£¡ï¼Ÿã€ï¼ˆæœŸå¾…ï¼‰
ç¬¬ 5 æ¬¡é»æ“Šï¼šã€Œæ²’æœ‰å®˜æ–¹é€£çµæˆ‘çœŸçš„ä¸æ•¢è²·ã€ï¼ˆç„¦æ…®ï¼‰
ç¬¬ 9 æ¬¡é»æ“Šï¼šã€Œè¦ä¸è¦è‡ªå·±å» TFDA æŸ¥ï¼Ÿã€ï¼ˆæ”¾æ£„ï¼‰
```

## æ­¥é©Ÿ 4ï¼šæŠ€è¡“å•é¡Œæª¢æŸ¥èˆ‡é é¢å…ƒç´ è­˜åˆ¥ï¼ˆæ–°å¢è¦æ±‚ï¼‰

æª¢æŸ¥ action åºåˆ—ä¸­çš„ç•°å¸¸æ¨¡å¼ï¼š
- target ID æ˜¯å¦è®ŠåŒ–ï¼Ÿï¼ˆå¯èƒ½æ˜¯é€£çµå¤±æ•ˆï¼‰
- æ˜¯å¦æœ‰é€£çºŒé»æ“Šç›¸åŒå…ƒç´ ä½†ç„¡é€²å±•ï¼Ÿï¼ˆå¯èƒ½æ˜¯å›é¥‹ä¸è¶³ï¼‰
- æ˜¯å¦æœ‰è·³èºå¼å°èˆªï¼Ÿï¼ˆå¯èƒ½æ˜¯è³‡è¨Šæ¶æ§‹å•é¡Œï¼‰

**ğŸ” ä½¿ç”¨ã€Œå…ƒç´ è³‡è¨Šæ˜ å°„ã€ä¸­çš„å¯¦éš› HTML class å’Œ id**ï¼š

âš ï¸ **é‡è¦**ï¼šåœ¨å»ºè­°ä¸­å¿…é ˆä½¿ç”¨ã€Œå…ƒç´ è³‡è¨Šæ˜ å°„ã€ä¸­æä¾›çš„**å¯¦éš› class å’Œ id**ï¼Œè€Œä¸æ˜¯çŒœæ¸¬æˆ–ä½¿ç”¨é€šç”¨åç¨±ï¼

1. **å¾ã€Œå…ƒç´ è³‡è¨Šæ˜ å°„ã€æŸ¥æ‰¾å¯¦éš›çš„ CSS é¸æ“‡å™¨**ï¼š
   - æ¯å€‹ target IDï¼ˆå¦‚ 'item33'ï¼‰éƒ½æœ‰å°æ‡‰çš„å¯¦éš›å…ƒç´ è³‡è¨Š
   - ä½¿ç”¨ `class` æ¬„ä½ä¸­çš„**å¯¦éš› class åç¨±**ï¼ˆä¾‹å¦‚ï¼šå¦‚æœ class æ˜¯ "product-detail__title ec-product-title"ï¼Œå°±ä½¿ç”¨ `.product-detail__title` æˆ– `.ec-product-title`ï¼‰
   - ä½¿ç”¨ `id` æ¬„ä½ä¸­çš„**å¯¦éš› id**ï¼ˆä¾‹å¦‚ï¼šå¦‚æœ id æ˜¯ "main-product-info"ï¼Œå°±ä½¿ç”¨ `#main-product-info`ï¼‰
   - ä½¿ç”¨ `tag` æ¬„ä½ä¾†è­˜åˆ¥å…ƒç´ é¡å‹ï¼ˆå¦‚ `button`ã€`a`ã€`div` ç­‰ï¼‰
   - ä½¿ç”¨ `data_attributes` ä¸­çš„ data å±¬æ€§ï¼ˆä¾‹å¦‚ï¼š`[data-product-id="123"]`ï¼‰

2. **å¦‚æœå…ƒç´ è³‡è¨Šæ˜ å°„ä¸­æ²’æœ‰å°æ‡‰è³‡è¨Š**ï¼š
   - åªä½¿ç”¨ target IDï¼ˆå¦‚ `[parser-semantic-id="item33"]`ï¼‰
   - åœ¨å»ºè­°ä¸­æ˜ç¢ºæ¨™è¨»ã€Œéœ€è¦é–‹ç™¼è€…ç¢ºèªå¯¦éš›çš„ CSS é¸æ“‡å™¨ã€
   - **çµ•å°ä¸è¦**æé€ æˆ–çŒœæ¸¬ class åç¨±

3. **å¾ action åºåˆ—æ¨æ¸¬é é¢åç¨±**ï¼š
   - æŸ¥çœ‹ action çš„ `description` æ¬„ä½æ¨æ¸¬é é¢ï¼ˆä¾‹å¦‚ï¼šã€Œé€²å…¥å¸¸æº«æ¿ƒé›ç²¾60å…¥å•†å“é ã€â†’ ã€ç”¢å“è©³æƒ…é ã€‘ï¼‰
   - å¦‚æœä½¿ç”¨è€…æåˆ°ã€Œå•†å“è¦æ ¼ã€ã€ã€Œç”¢å“é é¢ã€â†’ å°æ‡‰ã€ç”¢å“è©³æƒ…é ã€‘
   - å¦‚æœä½¿ç”¨è€…æåˆ°ã€Œè³¼ç‰©è»Šã€ã€ã€Œçµå¸³ã€â†’ å°æ‡‰ã€è³¼ç‰©è»Šé é¢ã€‘æˆ–ã€çµå¸³é é¢ã€‘

## æ­¥é©Ÿ 5ï¼šç”¢ç”Ÿå¯åŸ·è¡Œçš„æ”¹å–„å»ºè­°

æ¯å€‹å•é¡Œå°æ‡‰è‡³å°‘ä¸€å€‹æ”¹å–„å»ºè­°ï¼ŒåŒ…å«ï¼š
1. **å„ªå…ˆç´š**ï¼šP0 (ç«‹å³) / P1 (çŸ­æœŸ) / P2 (ä¸­æœŸ)
2. **å…·é«”è¡Œå‹•**ï¼ˆè‡³å°‘ 3 æ¢ï¼‰ï¼š
   - âš ï¸ **é—œéµè¦æ±‚ï¼šå¿…é ˆæ˜ç¢ºæ¨™ç¤ºé é¢å’Œå…ƒç´ ä½ç½®**
   - æ¯æ¢å»ºè­°å¿…é ˆéµå¾ªä»¥ä¸‹æ ¼å¼ï¼š
     * ã€é é¢åç¨±ã€‘ï¼šæ˜ç¢ºæŒ‡å‡ºæ˜¯å“ªå€‹é é¢ï¼ˆä¾‹å¦‚ï¼šç”¢å“è©³æƒ…é ã€è³¼ç‰©è»Šé é¢ã€çµå¸³é é¢ï¼‰
     * ã€å…ƒç´ ä½ç½®ã€‘ï¼šæ˜ç¢ºæŒ‡å‡ºæ˜¯é é¢ä¸Šçš„å“ªå€‹å€å¡Šæˆ–å…ƒç´ ï¼ˆä¾‹å¦‚ï¼šç”¢å“æ¨™é¡Œå€å¡Šã€åƒ¹æ ¼é¡¯ç¤ºå€åŸŸã€åŠ å…¥è³¼ç‰©è»ŠæŒ‰éˆ•ï¼‰
     * ã€å…·é«”è®Šæ›´ã€‘ï¼šæ˜ç¢ºèªªæ˜è¦æ”¹ä»€éº¼ã€å¾ä»€éº¼æ”¹åˆ°ä»€éº¼ï¼ˆä¾‹å¦‚ï¼šã€Œå­—é«”å¤§å°å¾ 12pt æ”¹ç‚º 16ptã€ã€ã€ŒæŒ‰éˆ•å°ºå¯¸å¾ 32Ã—32px æ”¹ç‚º 48Ã—48pxã€ï¼‰

   - **ç¯„ä¾‹æ ¼å¼**ï¼š
     * âŒ ä¸ä½³ï¼šã€Œæ”¹å–„å­—é«”å¤§å°ã€
     * âŒ ä¸ä½³ï¼šã€Œå°‡ç¶²ç«™å­—é«”å¤§å°èª¿æ•´ç‚ºè‡³å°‘ 14ptã€
     * âŒ ä¸ä½³ï¼šã€Œã€ç”¢å“è©³æƒ…é ã€‘çš„ã€ç”¢å“æ¨™é¡Œå€å¡Šã€‘(.product-title)ï¼š...ã€ï¼ˆä½¿ç”¨äº†çŒœæ¸¬çš„é€šç”¨ class åç¨±ï¼‰
     * âœ… è‰¯å¥½ï¼šã€Œã€ç”¢å“è©³æƒ…é ã€‘çš„ã€ç”¢å“æ¨™é¡Œå€å¡Šã€‘ï¼ˆå¾å…ƒç´ è³‡è¨Šæ˜ å°„ï¼šclass="ec-product-detail__title"ï¼Œä½¿ç”¨ `.ec-product-detail__title`ï¼‰ï¼šå°‡å­—é«”å¤§å°å¾ 12pt èª¿æ•´ç‚º 16ptã€
     * âœ… è‰¯å¥½ï¼šã€Œã€ç”¢å“è©³æƒ…é ã€‘çš„ã€åŠ å…¥è³¼ç‰©è»ŠæŒ‰éˆ•ã€‘ï¼ˆtarget ID: item30ï¼Œå¾å…ƒç´ è³‡è¨Šæ˜ å°„ï¼štag="button", class="add-cart-btn primary-btn"ï¼‰ï¼šå°‡æŒ‰éˆ•å°ºå¯¸å¾ 32Ã—32px å¢å¤§è‡³ 48Ã—48pxã€
     * âœ… è‰¯å¥½ï¼šå¦‚æœå…ƒç´ è³‡è¨Šæ˜ å°„ä¸­æ²’æœ‰ class è³‡è¨Šï¼šã€Œã€ç”¢å“è©³æƒ…é ã€‘çš„ã€å“ç‰Œå…¬å‘Šé€£çµã€‘ï¼ˆtarget ID: item3ï¼Œéœ€é–‹ç™¼è€…ç¢ºèªå¯¦éš› CSS é¸æ“‡å™¨ï¼‰ï¼šä¿®å¾©é€£çµå¤±æ•ˆå•é¡Œã€

   - å¦‚æœæ¶‰åŠè³‡æ–™ï¼Œå¿…é ˆåˆ—å‡ºè¦é¡¯ç¤ºçš„å…§å®¹ï¼ˆä¾‹å¦‚ï¼šã€Œé¡¯ç¤ºå¥å­—è™Ÿï¼šè¡›ç½²å¥é£Ÿå­—ç¬¬AXXXXXXè™Ÿã€ï¼‰
   - å¦‚æœæ¶‰åŠæŠ€è¡“ä¿®å¾©ï¼Œå¿…é ˆèªªæ˜å¦‚ä½•ä¿®å¾©ï¼ˆä¾‹å¦‚ï¼šã€Œæª¢æŸ¥é€£çµ href æ˜¯å¦æ­£ç¢ºã€ï¼‰
   - å¦‚æœå¯ä»¥å¾ action_trace ä¸­è­˜åˆ¥å‡ºå…ƒç´ çš„ target IDï¼Œå¿…é ˆåœ¨å»ºè­°ä¸­å¼•ç”¨è©² IDï¼ˆä¾‹å¦‚ï¼šã€Œä¿®å¾© target='item3' çš„ã€å“ç‰Œå…¬å‘Šã€é€£çµã€ï¼‰

3. **é æœŸæ•ˆæœé‡åŒ–**ï¼ˆä¾‹å¦‚ï¼šã€Œè½‰æ›ç‡å¾ 0% æå‡è‡³ 40-60%ã€ï¼‰
4. **å¯¦æ–½é›£åº¦è©•ä¼°**ï¼šç°¡å–® / ä¸­ç­‰ / å›°é›£ï¼ˆè€ƒé‡æŠ€è¡“è¤‡é›œåº¦ã€è³‡æºéœ€æ±‚ã€é¢¨éšªï¼‰
5. **æ‰€éœ€è³‡æº**ï¼ˆä¾‹å¦‚ï¼šã€Œå‰ç«¯å·¥ç¨‹å¸« 1 äººã€è¨­è¨ˆå¸« 0.5 äººã€1é€±é–‹ç™¼æ™‚é–“ã€ï¼‰
6. **å¯¦æ–½æ™‚é–“å»ºè­°**ï¼ˆä¾‹å¦‚ï¼šã€Œ1-2é€±å…§å®Œæˆã€ï¼‰

### ğŸ“ è¦–è¦ºè¨­è¨ˆæº–å‰‡åƒè€ƒæ¨¡æ¿ï¼ˆé‡å°å¹´é•·ä½¿ç”¨è€…ï¼‰

åœ¨æå‡ºæ”¹å–„å»ºè­°æ™‚ï¼Œ**ç‰¹åˆ¥æ˜¯ç•¶ Persona ç‚ºå¹´é•·ä½¿ç”¨è€…æ™‚**ï¼Œè«‹åƒè€ƒä»¥ä¸‹è¨­è¨ˆæº–å‰‡ï¼š

**å­—é«”èˆ‡å¯è®€æ€§ (Typography & Readability)**ï¼š
- ä½¿ç”¨ç„¡è¥¯ç·šå­—é«”ï¼ˆå¦‚ Arial, Helvetica, Verdanaï¼‰ï¼Œå› ç‚ºå®ƒå€‘åœ¨è¢å¹•ä¸Šæ›´æ˜“è¾¨è­˜
- å­—é«”å¤§å°æ‡‰è‡³å°‘ç‚º 12ptï¼ˆå»ºè­° 14-16ptï¼‰ï¼Œè‹¥å¯èƒ½å‰‡æä¾›å¯èª¿æ•´å¤§å°çš„é¸é …
- é¿å…åƒ…ä½¿ç”¨å¤§å¯«å­—æ¯ï¼Œå› ç‚ºé€™æœƒç ´å£å–®å­—çš„è¼ªå»“ï¼Œé™ä½é–±è®€é€Ÿåº¦
- è¡Œé–“è·å»ºè­°ç‚ºå­—é«”å¤§å°çš„ 1.5-2 å€ï¼ˆä¾‹å¦‚ï¼š16pt å­—é«”æ­é… 24-32pt è¡Œé«˜ï¼‰

**å°æ¯”åº¦èˆ‡è‰²å½© (Contrast & Color)**ï¼š
- ç¢ºä¿æ–‡å­—èˆ‡èƒŒæ™¯ä¹‹é–“æœ‰é«˜åº¦çš„æ˜åº¦å°æ¯”ï¼ˆå»ºè­°å°æ¯”åº¦è‡³å°‘ 4.5:1ï¼Œç†æƒ³ç‚º 7:1ï¼‰
- é»‘åº•ç™½å­—æˆ–ç™½åº•é»‘å­—æ˜¯æœ€ä½³é¸æ“‡
- ä¸è¦åƒ…ä¾é é¡è‰²ä¾†å‚³é”è³‡è¨Šï¼ˆä¾‹å¦‚ï¼šç´…è‰²ä»£è¡¨éŒ¯èª¤ï¼‰ï¼Œå› ç‚ºå¹´é•·è€…å°è‰²å½©çš„è¾¨åˆ¥åŠ›ï¼ˆå°¤å…¶æ˜¯è—ã€ç¶ è‰²ç³»ï¼‰æœƒä¸‹é™
- æ‡‰åŒæ™‚æ­é…åœ–ç¤ºæˆ–æ–‡å­—æ¨™ç±¤ä¾†è¼”åŠ©é¡è‰²è¨Šæ¯

**é–“è·èˆ‡ä½ˆå±€ (Spacing & Layout)**ï¼š
- å¢åŠ è¡Œé–“è·èˆ‡å­—é–“è·ï¼Œé¿å…è¦–è¦ºæ“æ“ ï¼ˆå»ºè­°è¡Œé«˜è‡³å°‘ç‚ºå­—é«”å¤§å°çš„ 1.5 å€ï¼‰
- å°è¦½å…ƒç´ æ‡‰ä¿æŒä¸€è‡´ï¼Œå›ºå®šåœ¨è¢å¹•çš„ç›¸åŒä½ç½®
- é¿å…åœ¨å–®ä¸€ç•«é¢ä¸­å‘ˆç¾éå¤šè³‡è¨Šï¼ˆä¸€æ¬¡å°ˆæ³¨æ–¼ä¸€å€‹ä¸»è¦ä»»å‹™ï¼‰
- ç•™ç™½ç©ºé–“å……è¶³ï¼Œé¿å…å…ƒç´ éæ–¼ç·Šå¯†

**äº’å‹•è¨­è¨ˆèˆ‡æ§åˆ¶é … (Interaction & Controls)**ï¼š
- è§¸æ§æŒ‰éˆ•æˆ–æ»‘é¼ é»æ“Šç›®æ¨™æ‡‰è¶³å¤ å¤§ï¼ˆè‡³å°‘ 44Ã—44 åƒç´ æˆ– 9.6 æ¯«ç±³è¦‹æ–¹ï¼‰
- æŒ‰éˆ•ä¹‹é–“æ‡‰æœ‰è¶³å¤ é–“è·ï¼ˆè‡³å°‘ 8-12 åƒç´ ï¼‰ï¼Œé¿å…èª¤é»
- æä¾›å³æ™‚ä¸”æ˜é¡¯çš„åé¥‹ï¼ˆå¦‚è¦–è¦ºè®ŠåŒ–ã€è²éŸ³æç¤ºï¼‰
- åé¥‹æ‡‰æ¸…æ¥šèªªæ˜æ“ä½œæ˜¯å¦æˆåŠŸï¼Œæˆ–ç™¼ç”Ÿäº†ä»€éº¼éŒ¯èª¤
- é¿å…ä½¿ç”¨è¤‡é›œçš„æ‰‹å‹¢ï¼ˆå¦‚å¤šæŒ‡ç¸®æ”¾ã€é•·æŒ‰å¾Œæ‹–æ‹½ï¼‰ï¼Œç°¡å–®çš„ã€Œé»æ“Šã€æ˜¯å°å¹´é•·è€…æœ€å‹å–„çš„äº’å‹•æ–¹å¼

**èªçŸ¥è² è·çš„å„ªåŒ– (Cognitive Load Optimization)**ï¼š
- ç°¡åŒ–æµç¨‹ï¼šæ¸›å°‘é”æˆç›®æ¨™æ‰€éœ€çš„æ­¥é©Ÿï¼Œæ¯ä¸€é è¢å¹•åªæ‡‰å‘ˆç¾ä¸€å€‹æ ¸å¿ƒä»»å‹™
- æ¸›å°‘è¨˜æ†¶è² æ“”ï¼šåˆ©ç”¨ã€Œè­˜åˆ¥ã€è€Œéã€Œå›æ†¶ã€ï¼ˆä¾‹å¦‚ï¼šæä¾›é¸é …é¸å–®ï¼Œè€Œä¸æ˜¯è®“ä½¿ç”¨è€…è‡ªå·±è¼¸å…¥ï¼‰
- æä¾›æ˜ç¢ºçš„å°è¦½è·¯å¾‘ï¼ˆå¦‚éºµåŒ…å±‘å°èˆªï¼‰ï¼Œè®“ä½¿ç”¨è€…çŸ¥é“è‡ªå·±ç›®å‰åœ¨ç³»çµ±ä¸­çš„ä½ç½®
- ä¸€è‡´æ€§ï¼šè¡“èªã€åœ–ç¤ºå’Œæ“ä½œé‚è¼¯åœ¨æ•´å€‹ç³»çµ±ä¸­å¿…é ˆä¿æŒé«˜åº¦ä¸€è‡´
- ä½¿ç”¨æ¸…æ™°ã€ç°¡å–®çš„èªè¨€ï¼Œé¿å…å°ˆæ¥­è¡“èªå’Œç¸®å¯«

**éŒ¯èª¤é˜²ç¯„èˆ‡æ¢å¾© (Error Prevention & Recovery)**ï¼š
- é é˜²éŒ¯èª¤ï¼šåœ¨åŸ·è¡Œä¸å¯é€†çš„æ“ä½œï¼ˆå¦‚åˆªé™¤ã€çµå¸³ï¼‰å‰ï¼Œæ‡‰å½ˆå‡ºç¢ºèªå°è©±æ¡†
- æ¸…æ™°çš„éŒ¯èª¤è¨Šæ¯ï¼šä¸è¦ä½¿ç”¨ä»£ç¢¼ï¼ˆå¦‚ Error 404ï¼‰ï¼Œæ‡‰ä½¿ç”¨æ˜“æ‡‚çš„èªè¨€è§£é‡‹å•é¡Œ
- æä¾›å…·é«”çš„ä¿®æ­£å»ºè­°ï¼ˆä¾‹å¦‚ï¼šã€Œè«‹è¼¸å…¥æ­£ç¢ºçš„ 10 ä½æ•¸é›»è©±è™Ÿç¢¼ã€è€Œä¸æ˜¯ã€Œè¼¸å…¥ç„¡æ•ˆã€ï¼‰
- æ’¤éŠ·åŠŸèƒ½ï¼šæä¾›ç°¡å–®çš„æ–¹æ³•è®“ä½¿ç”¨è€…èƒ½é€€å›åˆ°ä¸Šä¸€æ­¥ï¼ˆå¦‚æ˜é¡¯çš„ã€Œè¿”å›ã€æˆ–ã€Œå–æ¶ˆã€æŒ‰éˆ•ï¼‰
- å®¹éŒ¯è¨­è¨ˆï¼šç³»çµ±æ‡‰èƒ½å®¹å¿è¼•å¾®çš„è¼¸å…¥éŒ¯èª¤ï¼ˆå¦‚è‡ªå‹•ä¿®æ­£ã€æä¾›å»ºè­°ï¼‰

**æ‡‰ç”¨ç¯„ä¾‹**ï¼š
ç•¶æå‡ºæ”¹å–„å»ºè­°æ™‚ï¼Œæ‡‰å…·é«”èªªæ˜å¦‚ä½•æ‡‰ç”¨é€™äº›æº–å‰‡ã€‚ä¾‹å¦‚ï¼š
- âŒ ä¸ä½³ï¼šã€Œæ”¹å–„æŒ‰éˆ•è¨­è¨ˆã€
- âœ… è‰¯å¥½ï¼šã€Œå°‡ã€åŠ å…¥è³¼ç‰©è»Šã€æŒ‰éˆ•å°ºå¯¸å¾ 32Ã—32px å¢å¤§è‡³ 48Ã—48pxï¼ˆç¬¦åˆæœ€å°è§¸æ§ç›®æ¨™ 44Ã—44px æº–å‰‡ï¼‰ï¼Œä½¿ç”¨é«˜å°æ¯”è‰²ï¼ˆç™½åº•ç¶ å­—ï¼Œå°æ¯”åº¦ 7:1ï¼‰ï¼Œä¸¦åœ¨é»æ“Šå¾Œé¡¯ç¤ºã€âœ“ å·²åŠ å…¥è³¼ç‰©è»Šã€çš„æ˜ç¢ºåé¥‹è¨Šæ¯ï¼ˆå­—é«” 16ptï¼ŒæŒçºŒ 2 ç§’å¾Œè‡ªå‹•æ¶ˆå¤±ï¼‰ã€

## æ­¥é©Ÿ 6ï¼šç”¢ç”Ÿ UX æ”¹é€²è¡Œå‹•è¨ˆåŠƒï¼ˆæ–°å¢ï¼‰

åœ¨åˆ†æå®Œæ‰€æœ‰å•é¡Œå’Œå»ºè­°å¾Œï¼Œè«‹æ•´åˆæˆä¸€å€‹å®Œæ•´çš„è¡Œå‹•è¨ˆåŠƒï¼ŒæŒ‰æ™‚é–“è»¸çµ„ç¹”ï¼š

**çŸ­æœŸè¡Œå‹•ï¼ˆ1-2é€±å…§ï¼‰**ï¼š
- åˆ—å‡ºæ‰€æœ‰ P0 å„ªå…ˆç´šçš„æ”¹å–„é …ç›®
- èªªæ˜ç‚ºä»€éº¼é€™äº›é …ç›®å¿…é ˆç«‹å³åŸ·è¡Œ
- é ä¼°æ•´é«”å½±éŸ¿ï¼ˆä¾‹å¦‚ï¼šã€Œå¯å°‡è½‰æ›ç‡å¾ 0% æå‡è‡³ 30%ã€ï¼‰

**ä¸­æœŸè¡Œå‹•ï¼ˆ1-2å€‹æœˆå…§ï¼‰**ï¼š
- åˆ—å‡º P1 å„ªå…ˆç´šçš„æ”¹å–„é …ç›®
- èªªæ˜é€™äº›é …ç›®å¦‚ä½•åœ¨çŸ­æœŸæ”¹å–„çš„åŸºç¤ä¸Šé€²ä¸€æ­¥å„ªåŒ–
- é ä¼°ç´¯ç©å½±éŸ¿

**é•·æœŸè¡Œå‹•ï¼ˆ3-6å€‹æœˆå…§ï¼‰**ï¼š
- åˆ—å‡º P2 å„ªå…ˆç´šçš„æ”¹å–„é …ç›®å’Œç­–ç•¥æ€§æ”¹é€²
- èªªæ˜å¦‚ä½•å»ºç«‹é•·æœŸç«¶çˆ­å„ªå‹¢
- é ä¼°æœ€çµ‚æ•ˆæœ

æ¯å€‹æ™‚é–“æ®µé‚„éœ€åŒ…å«ï¼š
- **æˆåŠŸæŒ‡æ¨™**ï¼šå¦‚ä½•è¡¡é‡æ”¹å–„æ•ˆæœï¼ˆä¾‹å¦‚ï¼šè½‰æ›ç‡ã€è·³å‡ºç‡ã€å¹³å‡åœç•™æ™‚é–“ï¼‰
- **å¿«é€Ÿå‹åˆ©ï¼ˆQuick Winsï¼‰**ï¼šå“ªäº›æ”¹å–„å¯ä»¥åœ¨è©²æ™‚æ®µå…§æœ€å¿«è¦‹æ•ˆ
- **é¢¨éšªèˆ‡æŒ‘æˆ°**ï¼šå¯¦æ–½éç¨‹ä¸­å¯èƒ½é‡åˆ°çš„éšœç¤™

---

# è¼¸å‡ºæ ¼å¼

è«‹ä»¥ **JSON æ ¼å¼** å›æ‡‰ï¼Œçµæ§‹å¦‚ä¸‹ï¼š

**å¼·åˆ¶æª¢æŸ¥æ¸…å–®ï¼ˆè¼¸å‡ºå‰å¿…é ˆç¢ºèªï¼‰**ï¼š
âœ… ux_issues é™£åˆ—æœ‰è‡³å°‘ 4 å€‹å…ƒç´ ï¼Ÿ
âœ… æ¯å€‹å•é¡Œéƒ½å¼•ç”¨äº†è‡³å°‘ 5 æ¢ user_thoughtsï¼Ÿ
âœ… é‡è¤‡å‹•ä½œæ¬¡æ•¸æ˜¯å¾ action_frequency æº–ç¢ºæå–çš„ï¼Ÿ
âœ… æœ‰é€²è¡Œæ™‚é–“åºåˆ—åˆ†æï¼ˆbehavioral_patternsï¼‰ï¼Ÿ
âœ… å»ºè­°å¤ å…·é«”ï¼ˆæœ‰ UI æè¿°/æ•¸æ“šå…§å®¹/æŠ€è¡“æ–¹æ¡ˆï¼‰ï¼Ÿ
âœ… æ¯å€‹ recommendation éƒ½åŒ…å« implementation_difficulty å’Œ required_resourcesï¼Ÿ
âœ… åŒ…å«å®Œæ•´çš„ action_planï¼ˆçŸ­æœŸ/ä¸­æœŸ/é•·æœŸï¼‰ï¼Ÿ
âœ… **æ¯æ¢ specific_actions éƒ½æ˜ç¢ºæ¨™ç¤ºäº†ã€é é¢åç¨±ã€‘å’Œã€å…ƒç´ ä½ç½®ã€‘ï¼Ÿ**
âœ… **æ¯æ¢ specific_actions éƒ½åŒ…å«å…·é«”çš„æ•¸å€¼è®Šæ›´ï¼ˆä¾‹å¦‚ï¼šå¾ 12pt æ”¹ç‚º 16ptï¼‰ï¼Ÿ**
âœ… **å¦‚æœæ¶‰åŠå­—é«”ã€æŒ‰éˆ•ã€é–“è·ç­‰è¦–è¦ºå…ƒç´ ï¼Œæ˜¯å¦æä¾›äº†å…·é«”çš„å°ºå¯¸å’Œæ•¸å€¼ï¼Ÿ**
âœ… **ã€é‡è¦ã€‘CSS é¸æ“‡å™¨æ˜¯å¦ä¾†è‡ªã€Œå…ƒç´ è³‡è¨Šæ˜ å°„ã€ä¸­çš„å¯¦éš› class/idï¼Œè€ŒéçŒœæ¸¬çš„é€šç”¨åç¨±ï¼Ÿ**
âœ… **ã€é‡è¦ã€‘å¦‚æœå…ƒç´ è³‡è¨Šæ˜ å°„ä¸­æ²’æœ‰å°æ‡‰è³‡è¨Šï¼Œæ˜¯å¦æ¨™è¨»äº†ã€Œéœ€é–‹ç™¼è€…ç¢ºèªå¯¦éš› CSS é¸æ“‡å™¨ã€ï¼Ÿ**

{{
  "test_metadata": {{
    "persona_file": "persona_cautious_verifier_nianjia.txt",
    "persona_name": "{data['persona_info']['name']}",
    "persona_type": "{data['persona_info']['type']}",
    "analysis_timestamp": "ISO 8601 æ ¼å¼æ™‚é–“",
    "total_actions": {data['total_actions']},
    "total_thoughts": {data['total_thoughts']}
  }},
  "executive_summary": {{
    "task_completed": false,
    "completion_reason": "ä½¿ç”¨è€…ç„¡æ³•æ‰¾åˆ°å¥å­—è™Ÿ TFDA èªè­‰é€£çµï¼Œå› é©—è­‰éœ€æ±‚æœªæ»¿è¶³è€Œæ”¾æ£„è³¼è²·",
    "key_insight": "è¬¹æ…å‹ä½¿ç”¨è€…éœ€è¦æ¬Šå¨æ©Ÿæ§‹èƒŒæ›¸ï¼Œç¼ºä¹å®˜æ–¹èªè­‰å…¥å£æ˜¯è‡´å‘½éšœç¤™"
  }},
  "behavioral_patterns": [
    {{
      "pattern": "é‡è¤‡é»æ“Šå“ç‰Œå…¬å‘Šå°‹æ‰¾èªè­‰è³‡è¨Š",
      "evidence": "é€£çºŒé»æ“Šã€Œå“ç‰Œå…¬å‘Šã€9æ¬¡ï¼ˆå¾é‡è¤‡å‹•ä½œçµ±è¨ˆï¼šå“ç‰Œå…¬å‘Š=9ï¼‰ï¼Œå¾ action åºåˆ—ä¸­å¯è¦‹ target å¾ item3 è®Šæˆ gogoro_12_gogoro_11_ï¼Œå¯èƒ½è¡¨ç¤ºé€£çµå¤±æ•ˆæˆ–é é¢å…ƒç´  ID è®ŠåŒ–",
      "interpretation": "ä½¿ç”¨è€…æœŸå¾…åœ¨å“ç‰Œå…¬å‘Šä¸­æ‰¾åˆ°å¥å­—è™Ÿèªè­‰è³‡è¨Šï¼Œä½†é€£çµå¤±æ•ˆæˆ–å…§å®¹ä¸ç¬¦é æœŸï¼Œå°è‡´åè¦†å˜—è©¦",
      "timeline_evolution": {{
        "early_stage": "ç¬¬1æ¬¡é»æ“Šï¼šæœŸå¾…èƒ½æ‰¾åˆ°èªè­‰è³‡è¨Š",
        "mid_stage": "ç¬¬5æ¬¡é»æ“Šï¼šé–‹å§‹ç„¦æ…®ã€Œæ²’æœ‰å®˜æ–¹é€£çµæˆ‘çœŸçš„ä¸æ•¢è²·ã€",
        "late_stage": "ç¬¬9æ¬¡é»æ“Šï¼šæ±ºå®šæ”¾æ£„ç¶²ç«™ï¼Œè‡ªå·±å» TFDA æŸ¥è©¢"
      }}
    }},
    {{
      "pattern": "å°ç”¢å“è²ç¨±ç”¢ç”Ÿæ‡·ç–‘",
      "evidence": "å¤šæ¬¡è³ªç–‘ã€Œæ¯éš»é›åªåš 2.5 åŒ…ã€çš„ç”¢ç‡ï¼Œè¦æ±‚çœ‹è£½ç¨‹æ•¸æ“šå’Œå¯¦é©—å ±å‘Š",
      "interpretation": "é«˜é¢¨éšªæ„ŸçŸ¥çš„è¬¹æ…å‹ä½¿ç”¨è€…éœ€è¦ç§‘å­¸ä¾æ“šä¾†é©—è­‰è¡ŒéŠ·è²ç¨±"
    }}
  ],
  "ux_issues": [
    {{
      "title": "ç¼ºä¹å®˜æ–¹èªè­‰é©—è­‰å…¥å£ï¼ˆå¥å­—è™Ÿ TFDA é€£çµï¼‰",
      "severity": "CRITICAL",
      "category": "ä¿¡ä»»å»ºç«‹",
      "description": "ç”¢å“è²ç¨±ã€Œé€šéå¥å­—è™Ÿèªè­‰ã€æœ‰æ•ˆæŠ—ç–²å‹ã€ã€ä½†ç¶²ç«™æœªæä¾›ï¼š(1) å¥å­—è™Ÿæ ¸å¯ç·¨è™Ÿ (2) TFDA è³‡æ–™åº«æŸ¥è©¢é€£çµ (3) èªè­‰è­‰æ›¸ PDF ä¸‹è¼‰ (4) æª¢é©—å ±å‘Šä¸‹è¼‰ã€‚å°æ–¼é«˜é¢¨éšªæ„ŸçŸ¥çš„è¬¹æ…å‹ä½¿ç”¨è€…ï¼Œé€™æ˜¯è³¼è²·çš„è‡´å‘½éšœç¤™ã€‚",
      "user_thoughts": [
        "é‚£å€‹ã€æœ‰æ•ˆæŠ—ç–²å‹ã€çš„å¥å­—è™Ÿåˆ°åº•æ˜¯å“ªå€‹æ ¸å¯ç·¨è™Ÿï¼Ÿè¦æ˜¯èƒ½ç›´æ¥é€£åˆ°è¡›ç¦éƒ¨è³‡æ–™åº«å°±æ”¾å¿ƒå¤šäº†ã€‚",
        "é‚£å€‹å¥åº·å­—è™Ÿåˆ°åº•åœ¨å“ªä¸€é èƒ½ç›´æ¥é»é€² TFDA è³‡æ–™åº«ï¼Ÿæ²’æœ‰å®˜æ–¹é€£çµæˆ‘çœŸçš„ä¸æ•¢è²·ã€‚",
        "å¥å­—è™Ÿåˆ°åº•è—åœ¨å“ªä¸€é ï¼Ÿæ²’æœ‰ TFDA å¯æŸ¥é€£çµçœŸçš„ä¸è¡Œï¼Œè¦ä¸è¦ç›´æ¥å» TFDA è³‡æ–™åº«ç”¨é—œéµå­—åæŸ¥å“ç‰Œï¼Ÿ",
        "é‚„æ˜¯å…ˆå» TFDA è³‡æ–™åº«ç”¨é—œéµå­—æ‰¾ã€å¨˜å®¶ é›ç²¾ã€çœ‹çœ‹ï¼Œæœ‰æ²’æœ‰æ­£å¼æ ¸å¯å­—è™Ÿèƒ½å°ä¸Šï¼Ÿæ²’æœ‰å°±å…ˆä¸è²·ã€‚",
        "å…ˆæŠŠ TFDA è³‡æ–™åº«é—œéµå­—æ¸…å–®åˆ—å¥½ï¼šå“ç‰Œåã€ç”¢å“åã€ç”³è«‹å…¬å¸åä¸‰è·¯äº¤å‰æŸ¥ï¼Œé¿å…åªç”¨ã€é›ç²¾ã€é—œéµå­—æ¼æ‰ã€‚",
        "å…ˆæŠŠå¥åº·å­—è™Ÿæ‰¾åˆ°å†èªªï¼Œæ²’æœ‰ TFDA çš„ç›´æ¥é€£çµæˆ‘ä¸æœƒè²·â€”â€”æœƒä¸æœƒè—åœ¨å“ç‰Œå…¬å‘Šè£¡çš„ PDFï¼Ÿ"
      ],
      "impact": "è¬¹æ…å‹ä½¿ç”¨è€…å› ç„¡æ³•é©—è­‰ç”¢å“è²ç¨±çš„çœŸå¯¦æ€§è€Œå®Œå…¨æ”¾æ£„è³¼è²·ï¼ˆè½‰æ›ç‡ 0%ï¼‰ã€‚ä½¿ç”¨è€…éœ€è¦è‡ªè¡Œå» TFDA ç¶²ç«™æŸ¥è©¢ï¼Œå¢åŠ é¡å¤–å·¥ä½œè² æ“”ã€‚",
      "evidence": {{
        "repeated_actions": "é»æ“Šã€Œå“ç‰Œå…¬å‘Šã€9 æ¬¡å˜—è©¦å°‹æ‰¾èªè­‰è³‡è¨Šï¼ˆå¾é‡è¤‡å‹•ä½œçµ±è¨ˆï¼šå“ç‰Œå…¬å‘Š=9ï¼‰",
        "confusion_signals": "15+ æ¬¡æåˆ°ã€Œå¥å­—è™Ÿã€ã€ã€ŒTFDAã€ã€ã€Œè¡›ç¦éƒ¨ã€ã€ã€Œå®˜æ–¹é€£çµã€ã€ã€Œä¸æ•¢è²·ã€",
        "action_sequence_anomaly": "action target å¾ item3 è®Šæˆ gogoro_12_gogoro_11_ï¼Œå¯èƒ½è¡¨ç¤ºé€£çµå¤±æ•ˆ"
      }}
    }},
    {{
      "title": "ã€å“ç‰Œå…¬å‘Šã€é€£çµå¤±æ•ˆæˆ–æœªæ­£ç¢ºå›æ‡‰",
      "severity": "CRITICAL",
      "category": "å°èˆª",
      "description": "ä½¿ç”¨è€…é€£çºŒé»æ“Šã€å“ç‰Œå…¬å‘Šã€é€£çµ 9 æ¬¡ï¼Œä½†æ¯æ¬¡é»æ“Šå¾Œéƒ½æ²’æœ‰çœ‹åˆ°é æœŸçš„å…§å®¹ã€‚å¾ action_trace å¯è¦‹ target å¾ 'item3' è®Šæˆ 'gogoro_12_gogoro_11_'ï¼Œå¯èƒ½æ˜¯é é¢å…ƒç´  ID è®ŠåŒ–æˆ–é»æ“Šå€åŸŸé‡ç–Šå°è‡´ã€‚",
      "user_thoughts": [
        "é‚£å€‹å¥åº·å­—è™Ÿåˆ°åº•åœ¨å“ªä¸€é èƒ½ç›´æ¥é»é€²è¡›ç¦éƒ¨è³‡æ–™åº«ï¼Ÿæ²’æœ‰å®˜æ–¹é€£çµæˆ‘çœŸçš„ä¸æ•¢è²·ã€‚",
        "å…ˆæŠŠå¥åº·å­—è™Ÿæ‰¾åˆ°å†èªªï¼Œæ²’æœ‰ TFDA çš„ç›´æ¥é€£çµæˆ‘ä¸æœƒè²·â€”â€”æœƒä¸æœƒè—åœ¨å“ç‰Œå…¬å‘Šè£¡çš„ PDFï¼Ÿ",
        "æ™šé¤è¦ä¸è¦ç…®æ¸…ç²¥é…é»é¹¹èœï¼Ÿä½†åœ¨é‚£ä¹‹å‰å…ˆæŠŠå“ç‰Œå…¬å‘Šå’Œæª¢é©—å ±å‘Šç¿»å€‹åº•æœå¤©ã€‚",
        "æ™šé¤ç…®æ¸…ç²¥é…é¹¹èœæŒºå‰›å¥½ï¼Œé‚Šåƒé‚ŠæŠŠå“ç‰Œå…¬å‘Šå’Œæ‰€æœ‰è©•åƒ¹ç¿»åˆ°æœ€åº•ï¼Œçœ‹çœ‹æœ‰æ²’æœ‰å ±å‘Šç·¨è™Ÿã€‚"
      ],
      "impact": "9 æ¬¡é‡è¤‡é»æ“Š = 9 æ¬¡æŒ«æŠ˜ç¶“é©—ï¼Œæ¯æ¬¡å¤±æ•—éƒ½é™ä½å“ç‰Œä¿¡ä»»åº¦ã€‚ä½¿ç”¨è€…é™·å…¥å›°æƒ‘å¾ªç’°ï¼Œæµªè²»æ™‚é–“å’Œç²¾åŠ›ï¼Œæœ€çµ‚æ”¾æ£„ä»»å‹™ã€‚",
      "evidence": {{
        "repeated_actions": "é€£çºŒé»æ“Šã€å“ç‰Œå…¬å‘Šã€9 æ¬¡ï¼ˆå‹•ä½œ 6-13ï¼‰ï¼Œä½”ç¸½å‹•ä½œçš„ 64%",
        "confusion_signals": "å¾æœŸå¾…ã€Œæœƒä¸æœƒè—åœ¨å“ç‰Œå…¬å‘Šè£¡çš„ PDFã€åˆ°æ±ºå®šã€ŒæŠŠå“ç‰Œå…¬å‘Šç¿»å€‹åº•æœå¤©ã€ï¼Œé¡¯ç¤ºä½¿ç”¨è€…å …æŒå°‹æ‰¾ä½†æœªèƒ½æˆåŠŸ"
      }}
    }},
    {{
      "title": "ç”¢å“è²ç¨±ç¼ºä¹ç§‘å­¸æ•¸æ“šæ”¯æŒï¼ˆã€æ¯éš»é› 2.5 åŒ…ã€ç”¢ç‡ï¼‰",
      "severity": "HIGH",
      "category": "ä¿¡ä»»å»ºç«‹",
      "description": "ç”¢å“è²ç¨±ã€æ¯éš»é›åªèƒ½åšå‡º 2.5 åŒ…ã€ä½œç‚ºå“è³ªä¿è­‰ï¼Œä½†ä½¿ç”¨è€…èªç‚ºç”¢ç‡ã€å¯¦åœ¨ä½å¾—ä¸å¤ªç›´è¦ºã€ä¸¦è¦æ±‚çœ‹åˆ°è£½ç¨‹èªªæ˜ã€å¯¦é©—æ•¸æ“šã€ç¬¬ä¸‰æ–¹æª¢é©—å ±å‘Šä¾†é©—è­‰ã€‚",
      "user_thoughts": [
        "æ¯éš»é›åªåšå‡º 2.5 åŒ…çš„èªªæ³•æœ‰è³‡æ–™ä¾†æºå—ï¼Ÿä¹Ÿè¨±è¦å»çœ‹å¥å­—è™Ÿæˆ–æª¢é©—å ±å‘Šç´°ç¯€ã€‚",
        "æ¯åŒ… 65mlã€èªªæ¯éš»é›åªèƒ½åšå‡º 2.5 åŒ…ï¼Œé€™ç”¢ç‡å¯¦åœ¨ä½å¾—ä¸å¤ªç›´è¦ºâ€”â€”æ˜¯ä¸æ˜¯å› ç‚ºåªå–ç‰¹å®šéƒ¨ä½æˆ–é•·æ™‚é–“ä½æº«èƒå–ï¼Ÿæƒ³çœ‹åˆ°å¯¦é©—æˆ–è£½ç¨‹æ•¸æ“šã€‚",
        "æ¯éš»é›åªåš 2.5 åŒ…çš„èªªæ³•ï¼Œè‹¥ä¸€åŒ… 65mlï¼Œé‚£ä¸€éš»é›å¤§æ¦‚åªå‡º 160ml å·¦å³ï¼Œç”¢ç‡æ„Ÿè¦ºå¾ˆä½â€”â€”æœ‰æ²’æœ‰è£½ç¨‹æˆ–å¯¦é©—æ•¸æ“šä½è­‰ï¼Ÿ",
        "æ¯é›åªå‡º 2.5 åŒ…çš„èªªæ³•é‚„æ˜¯æ€ªæ€ªçš„ï¼Œ65ml ä¸€åŒ…ä»£è¡¨ä¸€éš»é›å¤§æ¦‚ 160ml ç”¢ç‡ï¼Œæœ‰æ²’æœ‰è£½ç¨‹æˆ–ç¬¬ä¸‰æ–¹æ•¸æ“šä½è­‰ï¼Ÿ"
      ],
      "impact": "è¬¹æ…å‹ä½¿ç”¨è€…å°ç”¢å“å“è³ªè²ç¨±ç”¢ç”Ÿæ‡·ç–‘ï¼Œé™ä½å“ç‰Œå¯ä¿¡åº¦ã€‚éœ€è¦é€æ˜çš„è£½ç¨‹èªªæ˜å’Œç§‘å­¸æ•¸æ“šä¾†å»ºç«‹ä¿¡ä»»ã€‚",
      "evidence": {{
        "repeated_actions": "å¤šæ¬¡åœ¨å…§å¿ƒæƒ³æ³•ä¸­è³ªç–‘ç”¢ç‡æ•¸æ“š",
        "confusion_signals": "4+ æ¬¡æåˆ°ã€Œç”¢ç‡ä½ã€ã€ã€Œä¸ç›´è¦ºã€ã€ã€Œè¦æ•¸æ“šä½è­‰ã€"
      }}
    }},
    {{
      "title": "è©•åƒ¹æ•¸é‡ä¸è¶³ï¼Œç¼ºä¹ç¤¾æœƒè­‰æ˜",
      "severity": "MEDIUM",
      "category": "ä¿¡ä»»å»ºç«‹",
      "description": "ç”¢å“åªæœ‰ 2 å‰‡è©•åƒ¹ï¼ˆçš†ç‚º 5 æ˜Ÿï¼‰ï¼Œè¬¹æ…å‹ä½¿ç”¨è€…èªç‚ºæ¨£æœ¬æ•¸å¤ªå°‘ï¼Œä¸è¶³ä»¥åˆ¤æ–·ç”¢å“å“è³ªï¼Œæƒ³è¦å°‹æ‰¾ç¬¬ä¸‰æ–¹è©•åƒ¹ï¼ˆPTTã€Dcardï¼‰ä¾†é©—è­‰ã€‚",
      "user_thoughts": [
        "å…©å‰‡äº”æ˜Ÿè©•åƒ¹æ¨£æœ¬å¤ªå°‘ï¼Œæ‰¾æ‰¾ PTT æˆ– Dcardã€Foodpanda è¶…å¸‚ç•™è¨€æœ‰æ²’æœ‰æ›´å¤šå¯¦æ¸¬å¿ƒå¾—ã€‚"
      ],
      "impact": "ç¼ºä¹ç¤¾æœƒè­‰æ˜ï¼ˆsocial proofï¼‰é™ä½è³¼è²·ä¿¡å¿ƒã€‚è¬¹æ…å‹ä½¿ç”¨è€…éœ€è¦æ›´å¤šçœŸå¯¦è©•åƒ¹æ‰èƒ½æ±ºç­–ã€‚",
      "evidence": {{
        "repeated_actions": "ç„¡é‡è¤‡å‹•ä½œï¼Œä½†åœ¨å…§å¿ƒæƒ³æ³•ä¸­æ˜ç¢ºè¡¨é”éœ€æ±‚",
        "confusion_signals": "æåˆ°è¦å»ç¬¬ä¸‰æ–¹å¹³å°å°‹æ‰¾è©•åƒ¹"
      }}
    }}
  ],
  "recommendations": [
    {{
      "priority": "P0 (ç«‹å³)",
      "title": "å»ºç«‹å®˜æ–¹èªè­‰é©—è­‰å°ˆå€",
      "category": "ä¿¡ä»»å»ºç«‹",
      "implementation_difficulty": "ä¸­ç­‰",
      "required_resources": "å‰ç«¯å·¥ç¨‹å¸« 1 äººã€å…§å®¹ç·¨è¼¯ 1 äººã€2é€±é–‹ç™¼æ™‚é–“",
      "rationale": "å°æ–¼é«˜é¢¨éšªæ„ŸçŸ¥çš„è¬¹æ…å‹ä½¿ç”¨è€…ï¼Œå®˜æ–¹èªè­‰æ˜¯è³¼è²·æ±ºç­–çš„å¿…è¦æ¢ä»¶ã€‚ç¼ºä¹èªè­‰å…¥å£å°è‡´ 100% è³¼è²·æ”¾æ£„ç‡ã€‚",
      "specific_actions": [
        "ã€ç”¢å“è©³æƒ…é ã€‘çš„ã€é é¢é ‚éƒ¨å€åŸŸã€‘ï¼ˆå¾å…ƒç´ è³‡è¨Šæ˜ å°„æŸ¥æ‰¾ï¼Œè‹¥ç„¡å‰‡æ¨™è¨»éœ€é–‹ç™¼è€…ç¢ºèªï¼‰ï¼šæ–°å¢ã€ğŸ… å®˜æ–¹èªè­‰è³‡è¨Šã€å€å¡Šï¼ŒåŒ…å«ï¼šè¡›ç¦éƒ¨å¥å­—è™Ÿï¼ˆä¾‹å¦‚ï¼šè¡›ç½²å¥é£Ÿå­—ç¬¬ AXXXXXX è™Ÿï¼‰ï¼Œå­—é«”å¤§å° 16ptï¼Œä½¿ç”¨é«˜å°æ¯”è‰²ï¼ˆé»‘åº•ç™½å­—ï¼Œå°æ¯”åº¦ 7:1ï¼‰",
        "ã€ç”¢å“è©³æƒ…é ã€‘çš„ã€èªè­‰è³‡è¨Šå€å¡Šã€‘ï¼ˆtarget ID å°æ‡‰çš„å¯¦éš› classï¼Œå¦‚ .ec-certification-blockï¼‰ï¼šæä¾›ã€æŸ¥çœ‹èªè­‰è­‰æ›¸ (PDF)ã€ä¸‹è¼‰é€£çµï¼ˆæŒ‰éˆ•å°ºå¯¸ 48Ã—120pxï¼‰å’Œã€ğŸ”— è¡›ç¦éƒ¨ TFDA è³‡æ–™åº«æŸ¥è©¢ã€å¤–éƒ¨é€£çµï¼ˆæŒ‰éˆ•å°ºå¯¸ 48Ã—180pxï¼‰",
        "ã€ç”¢å“è©³æƒ…é ã€‘çš„ã€å•†å“è¦æ ¼å€åŸŸä¸‹æ–¹ã€‘ï¼ˆå¾å…ƒç´ è³‡è¨Šæ˜ å°„ï¼štarget='item33' å°æ‡‰çš„ classï¼‰ï¼šæ–°å¢ã€SGS æª¢é©—å ±å‘Šã€å¯å±•é–‹å€å¡Š",
        "ã€ç”¢å“è©³æƒ…é ã€‘çš„ã€ç”¢å“æ¨™é¡Œæ—ã€‘ï¼ˆå¾å…ƒç´ è³‡è¨Šæ˜ å°„æŸ¥æ‰¾å¯¦éš› classï¼Œé¿å…ä½¿ç”¨çŒœæ¸¬çš„ .product-title-badgeï¼‰ï¼šåŠ å…¥èªè­‰å¾½ç« åœ–ç¤ºï¼ˆå°ºå¯¸ 32Ã—32pxï¼‰",
        "ã€ç”¢å“è©³æƒ…é ã€‘çš„ã€æ‰€æœ‰èªè­‰ç›¸é—œå…ƒç´ ã€‘ï¼ˆéœ€é–‹ç™¼è€…ç¢ºèªå¯¦éš› CSS é¸æ“‡å™¨ï¼‰ï¼šä½¿ç”¨é¡¯çœ¼çš„è¨­è¨ˆï¼ˆé«˜å°æ¯”è‰²ã€å­—é«”è‡³å°‘ 14ptï¼‰"
      ],
      "expected_impact": "è¬¹æ…å‹ä½¿ç”¨è€…è½‰æ›ç‡å¾ 0% æå‡è‡³ 40-60%ã€‚æ¸›å°‘å®¢æœè«®è©¢é‡ 30%ï¼ˆä½¿ç”¨è€…å¯è‡ªåŠ©é©—è­‰ï¼‰ã€‚å»ºç«‹é•·æœŸå“ç‰Œä¿¡ä»»ï¼Œæå‡å›è³¼ç‡ã€‚",
      "persona_alignment": "å®Œå…¨ç¬¦åˆè¬¹æ…é©—è­‰å‹ä½¿ç”¨è€…çš„æ ¸å¿ƒéœ€æ±‚ï¼šéœ€è¦æ¬Šå¨æ©Ÿæ§‹èƒŒæ›¸ã€å¯é©—è­‰çš„å®˜æ–¹è³‡è¨Šã€é™ä½è³¼è²·é¢¨éšªã€‚"
    }},
    {{
      "priority": "P0 (ç«‹å³)",
      "title": "ä¿®å¾©ã€å“ç‰Œå…¬å‘Šã€é€£çµä¸¦å„ªåŒ–å…§å®¹",
      "category": "å°èˆª",
      "rationale": "é€£çµå¤±æ•ˆå°è‡´ 9 æ¬¡é»æ“ŠæŒ«æŠ˜ï¼Œåš´é‡ç ´å£ä½¿ç”¨è€…é«”é©—å’Œå“ç‰Œä¿¡ä»»ã€‚",
      "specific_actions": [
        "æª¢æŸ¥ä¸¦ä¿®å¾©ã€å“ç‰Œå…¬å‘Šã€é€£çµï¼Œç¢ºä¿é»æ“Šå¾Œæ­£ç¢ºè·³è½‰åˆ°ç›®æ¨™é é¢",
        "åœ¨å“ç‰Œå…¬å‘Šé é¢ä¸­æ˜ç¢ºå±•ç¤ºï¼š(1) å…¬å¸å®Œæ•´åç¨±å’Œåœ°å€ (2) æ‰€æœ‰ç”¢å“çš„å¥å­—è™Ÿæ¸…å–® (3) ç¬¬ä¸‰æ–¹èªè­‰å’Œçé …",
        "æä¾›è¦–è¦ºå›é¥‹ï¼šé€£çµ hover æ™‚è®Šè‰²ã€é»æ“Šæ™‚é¡¯ç¤ºã€æ­£åœ¨è¼‰å…¥å“ç‰Œè³‡è¨Š...ã€éæ¸¡ç•«é¢",
        "åœ¨å“ç‰Œå…¬å‘Šä¸­åŠ å…¥ã€å¸¸è¦‹å•é¡Œ FAQã€å€å¡Šï¼Œé å…ˆå›ç­”ä½¿ç”¨è€…çš„é©—è­‰éœ€æ±‚ï¼ˆå¦‚ä½•æŸ¥è­‰å¥å­—è™Ÿã€å¦‚ä½•é©—è­‰ç”¢å“çœŸå½ï¼‰",
        "ä½¿ç”¨ breadcrumb å°èˆªï¼Œè®“ä½¿ç”¨è€…çŸ¥é“ç•¶å‰ä½ç½®ï¼ˆä¾‹å¦‚ï¼šé¦–é  > ç”¢å“é  > å“ç‰Œå…¬å‘Šï¼‰"
      ],
      "expected_impact": "é¿å…é‡è¤‡é»æ“ŠæŒ«æŠ˜ï¼Œæå‡ä½¿ç”¨è€…æ»¿æ„åº¦ã€‚å»ºç«‹å“ç‰Œå°ˆæ¥­å½¢è±¡ï¼Œå¢å¼·ä¿¡ä»»æ„Ÿã€‚",
      "persona_alignment": "è¬¹æ…å‹ä½¿ç”¨è€…ä¾è³´å“ç‰Œè³‡è¨Šåšé©—è­‰ï¼Œä¿®å¾©æ­¤é€£çµæ˜¯æ»¿è¶³å…¶éœ€æ±‚çš„é—œéµæ­¥é©Ÿã€‚"
    }},
    {{
      "priority": "P1 (çŸ­æœŸ)",
      "title": "å¢åŠ è£½ç¨‹é€æ˜åº¦èªªæ˜",
      "category": "ä¿¡ä»»å»ºç«‹",
      "rationale": "ä½¿ç”¨è€…å°ã€æ¯éš»é› 2.5 åŒ…ã€ç”¢ç‡ç”¢ç”Ÿè³ªç–‘ï¼Œéœ€è¦ç§‘å­¸è§£é‡‹ä¾†å»ºç«‹ä¿¡ä»»ã€‚",
      "specific_actions": [
        "æ–°å¢ã€ğŸ”¬ è£½ç¨‹èˆ‡å“è³ªä¿è­‰ã€æŠ˜ç–Šå€å¡Šï¼Œèªªæ˜ï¼š(1) åš´é¸å°ç£åœŸé›ï¼ˆå¹³å‡ 2.5-3kgï¼‰(2) åƒ…å–å…¨é›ç²¾è¯ï¼Œä½æº«ç†¬ç…® 3 å°æ™‚ (3) è’¸æ°£ä¸å›æµæŠ€è¡“ä¿ç•™ç‡Ÿé¤Š (4) æ¯éš»é›èƒå–æ¶²ç´„ 160-165ml (5) æ¯åŒ…è£ 65mlï¼Œæ•…ä¸€éš»é› â‰ˆ 2.5 åŒ…",
        "æä¾›è£½ç¨‹æµç¨‹åœ–æˆ–å½±ç‰‡é€£çµï¼Œè®“ä½¿ç”¨è€…è¦–è¦ºåŒ–ç†è§£",
        "å±•ç¤ºç¬¬ä¸‰æ–¹æª¢é©—æ•¸æ“šï¼šè›‹ç™½è³ªå«é‡ï¼ˆX.X g/100mlï¼‰ã€æ”¯éˆèƒºåŸºé…¸ï¼ˆXXX mg/100mlï¼‰ã€æ™®æ—å«é‡ï¼ˆXX mg/100mlï¼‰",
        "åŠ å…¥ã€ç‚ºä»€éº¼ç”¢ç‡é€™éº¼ä½ï¼Ÿã€FAQï¼Œè§£é‡‹é«˜å“è³ªèƒå–èˆ‡ç”¢ç‡çš„é—œä¿‚"
      ],
      "expected_impact": "æ¶ˆé™¤ä½¿ç”¨è€…å°ç”¢å“è²ç¨±çš„ç–‘æ…®ï¼Œæå‡å“è³ªèªçŸ¥ã€‚ç”¨æ•¸æ“šå’Œç§‘å­¸èªªæ˜å»ºç«‹å°ˆæ¥­å½¢è±¡ã€‚",
      "persona_alignment": "è¬¹æ…å‹ä½¿ç”¨è€…éœ€è¦è©³ç´°ã€å¯é©—è­‰çš„è³‡è¨Šä¾†é™ä½ä¸ç¢ºå®šæ€§ã€‚è£½ç¨‹é€æ˜åº¦ç¬¦åˆå…¶é©—è­‰å°å‘çš„æ±ºç­–æ¨¡å¼ã€‚"
    }},
    {{
      "priority": "P1 (çŸ­æœŸ)",
      "title": "å¢åŠ ç¤¾æœƒè­‰æ˜ï¼ˆè©•åƒ¹å’Œç¬¬ä¸‰æ–¹é€£çµï¼‰",
      "category": "ä¿¡ä»»å»ºç«‹",
      "rationale": "2 å‰‡è©•åƒ¹æ¨£æœ¬æ•¸ä¸è¶³ï¼Œè¬¹æ…å‹ä½¿ç”¨è€…éœ€è¦æ›´å¤šçœŸå¯¦è©•åƒ¹ä¾†å»ºç«‹ä¿¡å¿ƒã€‚",
      "specific_actions": [
        "é¼“å‹µå·²è³¼è²·é¡§å®¢è©•åƒ¹ï¼šè³¼è²·å¾Œ 7 å¤©è‡ªå‹•ç™¼é€è©•åƒ¹é‚€è«‹éƒµä»¶ï¼Œæä¾›è©•åƒ¹çå‹µï¼ˆç´…åˆ©é»æ•¸ 50 é»ï¼‰",
        "æ•´åˆç¬¬ä¸‰æ–¹è©•åƒ¹å€å¡Šï¼šã€ğŸ’¬ é¡§å®¢è©•åƒ¹ï¼ˆå…± XXX å‰‡ï¼‰ã€ï¼ŒåŒ…å«æœ¬ç«™è©•åƒ¹ + PTT/Dcard è¨è«–ä¸²é€£çµ + Google è©•è«–",
        "é¡¯ç¤ºã€âœ“ å·²é©—è­‰è³¼è²·ã€æ¨™è¨˜ï¼Œå¢åŠ è©•åƒ¹å¯ä¿¡åº¦",
        "å±•ç¤ºè©•åƒ¹åˆ†ä½ˆï¼ˆ5 æ˜Ÿ XX%ã€4 æ˜Ÿ XX%ï¼‰å’Œé—œéµå­—æ¨™ç±¤ï¼ˆã€å£æ„Ÿå¥½ã€ã€ã€æœ‰æ•ˆã€ã€ã€æ–°é®®ã€ï¼‰",
        "åŠ å…¥ã€å¸¸è¦‹æå•ã€å€å¡Šï¼Œæ•´ç†çœŸå¯¦é¡§å®¢çš„å•é¡Œå’Œå®˜æ–¹å›ç­”"
      ],
      "expected_impact": "æå‡ç¤¾æœƒè­‰æ˜ï¼Œé™ä½è³¼è²·é¢¨éšªæ„ŸçŸ¥ã€‚è©•åƒ¹æ•¸é‡å¢åŠ å¾Œï¼Œè½‰æ›ç‡é æœŸæå‡ 15-25%ã€‚",
      "persona_alignment": "è¬¹æ…å‹ä½¿ç”¨è€…é‡è¦–ä»–äººç¶“é©—ï¼Œå¤šå…ƒè©•åƒ¹ä¾†æºèƒ½å¢å¼·å…¶è³¼è²·ä¿¡å¿ƒã€‚"
    }},
    {{
      "priority": "P2 (ä¸­æœŸ)",
      "title": "æä¾›è©¦ç”¨æ–¹æ¡ˆé™ä½è³¼è²·é¢¨éšª",
      "category": "å…¶ä»–",
      "rationale": "è¬¹æ…å‹ä½¿ç”¨è€…å‚¾å‘ã€å…ˆè©¦æ°´æº«ã€å†æ±ºå®šæ˜¯å¦å¤§é‡è³¼è²·ã€‚",
      "specific_actions": [
        "æ¨å‡ºã€é«”é©—çµ„ï¼ˆ10 å…¥ï¼‰ã€æ–¹æ¡ˆï¼Œå®šåƒ¹ NT$1,580ï¼ˆå¹³å‡ NT$158/åŒ…ï¼‰ï¼Œæ¨™è¨»ã€â­ é©åˆé¦–æ¬¡è³¼è²·ï¼Œå°åŒ…è£è©¦ç”¨ã€",
        "åœ¨ç”¢å“é é¢æ–°å¢è³¼è²·æ–¹æ¡ˆé¸æ“‡å™¨ï¼Œæ¸…æ¥šå°æ¯”ï¼šé«”é©—çµ„ vs. å®¶åº­çµ„ï¼ˆ20 å…¥ï¼‰vs. å›¤è²¨çµ„ï¼ˆ40 å…¥ï¼‰",
        "æä¾›ã€30 å¤©æ»¿æ„ä¿è­‰ã€ï¼šä¸æ»¿æ„å¯é€€è²¨ï¼ˆæœªé–‹å°ï¼‰ï¼Œé‹è²»ç”±å…¬å¸è² æ“”",
        "åŠ å…¥ã€ç”¢åœ°æº¯æºã€åŠŸèƒ½ï¼šæƒæ QR Code æŸ¥çœ‹é›éš»ä¾†æºç‰§å ´è³‡è¨Š",
        "æ–°å¢ã€æ–°é®®é…é€ä¿è­‰ã€èªªæ˜ï¼šå†·å‡å®…é…ï¼Œä¿è­‰ 6 å€‹æœˆæœ‰æ•ˆæœŸå…§åˆ°è²¨"
      ],
      "expected_impact": "é™ä½é¦–æ¬¡è³¼è²·é–€æª»ï¼Œå¸å¼•è¬¹æ…å‹ä½¿ç”¨è€…å˜—è©¦ã€‚è©¦ç”¨å¾Œæ»¿æ„ç‡é«˜å‰‡å¸¶å‹•å‡ç´šè³¼è²·ï¼ˆ20 å…¥æˆ– 40 å…¥ï¼‰ã€‚",
      "persona_alignment": "ç¬¦åˆè¬¹æ…å‹ä½¿ç”¨è€…ã€é©—è­‰å¾Œå†æ±ºå®šã€çš„å¿ƒæ…‹ï¼Œé™ä½ä¸€æ¬¡æ€§å¤§é‡è³¼è²·çš„å¿ƒç†å£“åŠ›ã€‚"
    }}
  ],
  "persona_insights": {{
    "risk_perception_manifestation": "é«˜é¢¨éšªæ„ŸçŸ¥é«”ç¾åœ¨ï¼š(1) 15+ æ¬¡æåˆ°éœ€è¦å®˜æ–¹é©—è­‰ï¼ˆå¥å­—è™Ÿã€TFDAã€è¡›ç¦éƒ¨ï¼‰(2) è³ªç–‘ç”¢å“è²ç¨±ä¸¦è¦æ±‚ç§‘å­¸æ•¸æ“š (3) å°‹æ‰¾ç¬¬ä¸‰æ–¹è©•åƒ¹ï¼ˆPTTã€Dcardï¼‰(4) æœªé©—è­‰å°±ä¸è³¼è²·çš„å …æ±ºæ…‹åº¦",
    "self_efficacy_manifestation": "ä½è‡ªæˆ‘æ•ˆèƒ½é«”ç¾åœ¨ï¼š(1) ä¾è³´å¤–éƒ¨æ¬Šå¨ï¼ˆè¡›ç¦éƒ¨ã€TFDAï¼‰åšæ±ºç­– (2) éœ€è¦è©³ç´°æŒ‡å¼•å’Œæ˜ç¢ºæ¨™ç¤º (3) åè¦†ç¢ºèªç›¸åŒè³‡è¨Šï¼ˆé‡è¤‡é»æ“Šï¼‰(4) é¢å°è³‡è¨Šä¸è¶³æ™‚é¸æ“‡æ”¾æ£„è€Œéè‡ªè¡Œåˆ¤æ–·",
    "strategy_effectiveness": "é©—è­‰å°å‘ç­–ç•¥åŸ·è¡Œå¤±æ•—ã€‚ä½¿ç”¨è€…å˜—è©¦é€éã€å•†å“è¦æ ¼ã€ã€ã€è©³ç´°èªªæ˜ã€ã€ã€å“ç‰Œå…¬å‘Šã€ä¾†é©—è­‰ç”¢å“å®‰å…¨æ€§ï¼Œä½†ç¶²ç«™æœªæä¾›æ‰€éœ€çš„å®˜æ–¹èªè­‰è³‡è¨Šï¼Œå°è‡´ä»»å‹™ç„¡æ³•å®Œæˆã€‚ç­–ç•¥æœ¬èº«æ­£ç¢ºï¼Œä½†ç¶²ç«™è¨­è¨ˆä¸æ”¯æŒã€‚",
    "unmet_needs": [
      "éœ€è¦å¥å­—è™Ÿæ ¸å¯ç·¨è™Ÿå’Œ TFDA è³‡æ–™åº«æŸ¥è©¢é€£çµä¾†é©—è­‰å®˜æ–¹èªè­‰",
      "éœ€è¦èªè­‰è­‰æ›¸ PDF å’Œæª¢é©—å ±å‘Šä¸‹è¼‰ä¾†ç¢ºèªç”¢å“å®‰å…¨æ€§",
      "éœ€è¦è©³ç´°çš„è£½ç¨‹èªªæ˜å’Œç§‘å­¸æ•¸æ“šä¾†ç†è§£ç”¢å“è²ç¨±ï¼ˆã€æ¯éš»é› 2.5 åŒ…ã€ï¼‰",
      "éœ€è¦æ›´å¤šçœŸå¯¦è©•åƒ¹å’Œç¬¬ä¸‰æ–¹è¨è«–ä¾†å»ºç«‹ç¤¾æœƒè­‰æ˜",
      "éœ€è¦è©¦ç”¨æ–¹æ¡ˆä¾†é™ä½é¦–æ¬¡è³¼è²·çš„é¢¨éšª",
      "éœ€è¦ç”¢åœ°æº¯æºå’Œå“è³ªä¿è­‰æ©Ÿåˆ¶ä¾†å»ºç«‹é•·æœŸä¿¡ä»»"
    ]
  }},
  "comparison_notes": {{
    "efficiency_vs_cautious": "æ•ˆç‡å‹ä½¿ç”¨è€…ï¼ˆå¦‚ Mr. Chenï¼‰éœ€è¦ã€å¿«é€Ÿã€æ˜ç¢ºçš„æ“ä½œå›é¥‹ã€ï¼Œä¸»è¦å•é¡Œæ˜¯è¦–è¦ºå›é¥‹ä¸è¶³å°è‡´é‡è¤‡é»æ“Šã€åŠ å…¥è³¼ç‰©è»Šã€2 æ¬¡ã€‚è¬¹æ…å‹ä½¿ç”¨è€…ï¼ˆå¦‚ Mrs. Wangï¼‰éœ€è¦ã€è©³ç´°ã€å¯é©—è­‰çš„å®‰å…¨è³‡è¨Šã€ï¼Œä¸»è¦å•é¡Œæ˜¯ç¼ºä¹å®˜æ–¹èªè­‰å…¥å£å’Œè£½ç¨‹é€æ˜åº¦ï¼Œå°è‡´å®Œå…¨æ”¾æ£„è³¼è²·ã€‚å…©ç¨® persona çš„æ ¸å¿ƒéœ€æ±‚å®Œå…¨ä¸åŒï¼šæ•ˆç‡å‹é‡è¦–ã€é€Ÿåº¦ã€ï¼Œè¬¹æ…å‹é‡è¦–ã€å®‰å…¨ã€ã€‚æ”¹å–„ç­–ç•¥ä¹Ÿéœ€åˆ†åˆ¥é‡å°ï¼šæ•ˆç‡å‹éœ€è¦å¢å¼·å›é¥‹æ©Ÿåˆ¶ï¼Œè¬¹æ…å‹éœ€è¦å»ºç«‹ä¿¡ä»»ç³»çµ±ã€‚"
  }},
  "action_plan": {{
    "short_term": {{
      "timeframe": "1-2é€±å…§",
      "actions": [
        {{
          "title": "å»ºç«‹å®˜æ–¹èªè­‰é©—è­‰å°ˆå€",
          "priority": "P0",
          "implementation_difficulty": "ä¸­ç­‰",
          "required_resources": "å‰ç«¯å·¥ç¨‹å¸« 1 äººã€å…§å®¹ç·¨è¼¯ 1 äººã€2é€±é–‹ç™¼æ™‚é–“",
          "quick_win": true,
          "rationale": "ç«‹å³è§£æ±ºè¬¹æ…å‹ä½¿ç”¨è€…çš„æ ¸å¿ƒç—›é»"
        }},
        {{
          "title": "ä¿®å¾©å“ç‰Œå…¬å‘Šé€£çµ",
          "priority": "P0",
          "implementation_difficulty": "ç°¡å–®",
          "required_resources": "å‰ç«¯å·¥ç¨‹å¸« 0.5 äººã€1é€±é–‹ç™¼æ™‚é–“",
          "quick_win": true,
          "rationale": "æŠ€è¡“ä¿®å¾©ï¼Œå¿«é€Ÿæ¶ˆé™¤é‡è¤‡é»æ“ŠæŒ«æŠ˜"
        }}
      ],
      "success_metrics": [
        "P0 å•é¡Œä¿®å¾©ç‡ 100%",
        "è½‰æ›ç‡å¾ 0% æå‡è‡³ 30-40%",
        "é‡è¤‡é»æ“Šæ¬¡æ•¸æ¸›å°‘ 80%"
      ],
      "expected_impact": "ç«‹å³è§£æ±ºå°è‡´ä»»å‹™å¤±æ•—çš„é—œéµéšœç¤™ï¼Œè®“ä½¿ç”¨è€…èƒ½å¤ å®Œæˆé©—è­‰æµç¨‹ä¸¦å»ºç«‹åŸºæœ¬ä¿¡ä»»",
      "risks_and_challenges": [
        "éœ€è¦å–å¾—å¥å­—è™Ÿè­‰æ›¸å’Œæª¢é©—å ±å‘Šçš„é›»å­æª”",
        "é€£çµä¿®å¾©å¯èƒ½æ¶‰åŠåº•å±¤æ¶æ§‹å•é¡Œ"
      ]
    }},
    "mid_term": {{
      "timeframe": "1-2å€‹æœˆå…§",
      "actions": [
        {{
          "title": "å¢åŠ è£½ç¨‹é€æ˜åº¦èªªæ˜",
          "priority": "P1",
          "implementation_difficulty": "ä¸­ç­‰",
          "required_resources": "è¨­è¨ˆå¸« 1 äººã€å…§å®¹ç·¨è¼¯ 1 äººã€å½±ç‰‡è£½ä½œï¼ˆå¤–åŒ…ï¼‰ã€1å€‹æœˆæ™‚é–“",
          "rationale": "é€²ä¸€æ­¥å¢å¼·å“ç‰Œå°ˆæ¥­å½¢è±¡å’Œç”¢å“å¯ä¿¡åº¦"
        }},
        {{
          "title": "å¢åŠ ç¤¾æœƒè­‰æ˜æ©Ÿåˆ¶",
          "priority": "P1",
          "implementation_difficulty": "ä¸­ç­‰",
          "required_resources": "å¾Œç«¯+å‰ç«¯å·¥ç¨‹å¸«å„ 1 äººã€è¡ŒéŠ· 0.5 äººã€1.5å€‹æœˆæ™‚é–“",
          "rationale": "å»ºç«‹é•·æœŸä¿¡ä»»æ©Ÿåˆ¶ï¼Œæå‡æŒçºŒè½‰æ›ç‡"
        }}
      ],
      "success_metrics": [
        "è©•åƒ¹æ•¸é‡å¾ 2 å‰‡å¢åŠ è‡³ 50+ å‰‡",
        "è½‰æ›ç‡æå‡è‡³ 50-60%",
        "å“ç‰Œä¿¡ä»»åº¦è©•åˆ†æå‡ 30%"
      ],
      "expected_impact": "å»ºç«‹å®Œæ•´çš„ä¿¡ä»»ç”Ÿæ…‹ç³»çµ±ï¼Œå¾å®˜æ–¹èªè­‰æ“´å±•åˆ°è£½ç¨‹é€æ˜åº¦å’Œç¤¾æœƒè­‰æ˜",
      "risks_and_challenges": [
        "è£½ç¨‹å½±ç‰‡è£½ä½œéœ€è¦å”èª¿ç”Ÿç”¢ç«¯æ‹æ”",
        "è©•åƒ¹æ”¶é›†éœ€è¦æ™‚é–“ç´¯ç©ï¼ˆ1-2å€‹æœˆï¼‰"
      ]
    }},
    "long_term": {{
      "timeframe": "3-6å€‹æœˆå…§",
      "actions": [
        {{
          "title": "å»ºç«‹è©¦ç”¨æ–¹æ¡ˆå’Œé¢¨éšªé™ä½æ©Ÿåˆ¶",
          "priority": "P2",
          "implementation_difficulty": "å›°é›£",
          "required_resources": "ç”¢å“ç¶“ç†+å¾Œç«¯+å‰ç«¯å·¥ç¨‹å¸«å„ 1 äººã€ç‰©æµå”èª¿ã€3å€‹æœˆæ™‚é–“",
          "rationale": "é™ä½é¦–æ¬¡è³¼è²·é–€æª»ï¼Œå»ºç«‹é•·æœŸå®¢æˆ¶é—œä¿‚"
        }},
        {{
          "title": "å»ºç«‹ç”¢åœ°æº¯æºç³»çµ±",
          "priority": "P2",
          "implementation_difficulty": "å›°é›£",
          "required_resources": "å¾Œç«¯å·¥ç¨‹å¸« 2 äººã€ä¾›æ‡‰éˆå”èª¿ã€4-6å€‹æœˆæ™‚é–“",
          "rationale": "å»ºç«‹è¡Œæ¥­é ˜å…ˆçš„é€æ˜åº¦æ¨™æº–"
        }}
      ],
      "success_metrics": [
        "è©¦ç”¨çµ„è½‰æ›ç‡ï¼ˆè©¦ç”¨å¾Œè³¼è²·ï¼‰ > 70%",
        "æ•´é«”è½‰æ›ç‡é” 60-70%",
        "å®¢æˆ¶çµ‚èº«åƒ¹å€¼æå‡ 50%"
      ],
      "expected_impact": "å»ºç«‹è¡Œæ¥­é ˜å…ˆçš„ä¿¡ä»»æ¨™æº–å’Œé•·æœŸå“ç‰Œè­·åŸæ²³",
      "risks_and_challenges": [
        "è©¦ç”¨æ–¹æ¡ˆå¯èƒ½å½±éŸ¿åˆ©æ½¤ç‡",
        "ç”¢åœ°æº¯æºéœ€è¦ä¾›æ‡‰éˆå…¨é¢é…åˆ"
      ]
    }},
    "overall_impact_summary": "é€éçŸ­æœŸï¼ˆP0ï¼‰ã€ä¸­æœŸï¼ˆP1ï¼‰ã€é•·æœŸï¼ˆP2ï¼‰çš„æ¼¸é€²å¼æ”¹å–„ï¼Œé æœŸå¯å°‡è½‰æ›ç‡å¾ 0% é€æ­¥æå‡è‡³ 60-70%ï¼ŒåŒæ™‚å»ºç«‹å“ç‰Œä¿¡ä»»ç”Ÿæ…‹ç³»çµ±å’Œè¡Œæ¥­é ˜å…ˆåœ°ä½ã€‚",
    "persona_specific_note": "æ­¤è¡Œå‹•è¨ˆåŠƒå°ˆç‚ºè¬¹æ…é©—è­‰å‹ä½¿ç”¨è€…è¨­è¨ˆï¼Œæ¯å€‹éšæ®µé‡å°å…¶æ ¸å¿ƒéœ€æ±‚ï¼šçŸ­æœŸæ»¿è¶³é©—è­‰éœ€æ±‚ï¼Œä¸­æœŸå»ºç«‹å¤šå±¤æ¬¡ä¿¡ä»»ï¼Œé•·æœŸé™ä½é¢¨éšªæ„ŸçŸ¥ä¸¦å»ºç«‹é•·æœŸé—œä¿‚ã€‚"
  }}
}}

---

# æœ€å¾Œæé†’

1. **è‡³å°‘æ‰¾å‡º 3-5 å€‹å…·é«”å•é¡Œ**ï¼Œä¸è¦åªæœ‰ä¸€å€‹æ³›åŒ–çš„ã€Œè³‡è¨Šåˆ†æ•£ã€
2. **æ¯å€‹å•é¡Œå¼•ç”¨ 3-5 æ¢ä½¿ç”¨è€…æƒ³æ³•**ï¼Œç”¨åŸæ–‡å¼•ç”¨ä¸è¦æ”¹å¯«
3. **å¾é‡è¤‡å‹•ä½œçµ±è¨ˆä¸­æå–å…·é«”æ¬¡æ•¸**ï¼ˆä¾‹å¦‚ï¼šã€Œé»æ“Šã€å“ç‰Œå…¬å‘Šã€9 æ¬¡ã€ï¼‰
4. **å»ºè­°è¦éå¸¸å…·é«”**ï¼ˆä¾‹å¦‚ï¼šã€Œåœ¨ç”¢å“é é¢é ‚éƒ¨æ–°å¢...ã€è€Œä¸æ˜¯ã€Œæ”¹å–„è³‡è¨Šæ¶æ§‹ã€ï¼‰
5. **åš´é‡ç¨‹åº¦è¦æº–ç¢º**ï¼šå°è‡´ä»»å‹™å¤±æ•— = CRITICALï¼Œåš´é‡å½±éŸ¿é«”é©— = HIGH
6. **å¿…é ˆåŒ…å« action_plan**ï¼šæ•´åˆæ‰€æœ‰å»ºè­°åˆ°çŸ­æœŸ/ä¸­æœŸ/é•·æœŸè¡Œå‹•è¨ˆåŠƒä¸­
7. **ğŸ”´ é—œéµæé†’ï¼šæ¯æ¢ specific_actions å¿…é ˆä½¿ç”¨æ ¼å¼ã€é é¢åç¨±ã€‘çš„ã€å…ƒç´ ä½ç½®ã€‘ï¼šå…·é«”è®Šæ›´å…§å®¹**
   - ä¾‹å¦‚ï¼šã€Œã€ç”¢å“è©³æƒ…é ã€‘çš„ã€ç”¢å“æ¨™é¡Œå€å¡Šã€‘(.product-title)ï¼šå°‡å­—é«”å¤§å°å¾ 12pt èª¿æ•´ç‚º 16ptã€
   - ä¸å¯ä»¥åªå¯«ï¼šã€Œå°‡ç¶²ç«™å­—é«”å¤§å°èª¿æ•´ç‚ºè‡³å°‘ 14ptã€
   - å¿…é ˆæ˜ç¢ºæ¨™ç¤ºé é¢ã€å…ƒç´ ã€å…·é«”æ•¸å€¼
8. **ğŸ”´ğŸ”´ æœ€é‡è¦ï¼šCSS é¸æ“‡å™¨å¿…é ˆä¾†è‡ªã€Œå…ƒç´ è³‡è¨Šæ˜ å°„ã€ä¸­çš„å¯¦éš› class/id**
   - åœ¨ã€Œå…ƒç´ è³‡è¨Šæ˜ å°„ã€ä¸­æŸ¥æ‰¾å°æ‡‰ target ID çš„ class å’Œ id
   - ä½¿ç”¨å¯¦éš›çš„ class åç¨±ï¼ˆå¦‚ `.ec-product-detail__title`ï¼‰ï¼Œè€Œä¸æ˜¯çŒœæ¸¬çš„é€šç”¨åç¨±ï¼ˆå¦‚ `.product-title`ï¼‰
   - å¦‚æœæ²’æœ‰å°æ‡‰è³‡è¨Šï¼Œæ¨™è¨»ã€Œéœ€é–‹ç™¼è€…ç¢ºèªå¯¦éš› CSS é¸æ“‡å™¨ã€
   - **çµ•å°ç¦æ­¢**æé€ æˆ–çŒœæ¸¬ class åç¨±

è«‹ç›´æ¥è¼¸å‡º JSONï¼Œç¢ºä¿æ ¼å¼æ­£ç¢ºã€‚
"""
        return prompt

    def _parse_llm_response(self, response_text: str) -> Dict[str, Any]:
        """è§£æ LLM çš„ JSON å›æ‡‰"""
        try:
            return json.loads(response_text.strip())
        except json.JSONDecodeError as e:
            print(f"âŒ è§£æ LLM å›æ‡‰å¤±æ•—: {e}")
            print(f"å›æ‡‰å…§å®¹:\n{response_text[:500]}...")
            return {
                "error": "Failed to parse LLM response",
                "raw_response": response_text
            }


def generate_markdown_report(analysis: Dict[str, Any], persona_info: Dict, run_dir: Path) -> str:
    """æ ¹æ“š LLM åˆ†æçµæœç”¢ç”Ÿ Markdown å ±å‘Š"""

    # æå–æ¸¬è©¦å…ƒæ•¸æ“š
    test_metadata = analysis.get('test_metadata', {})

    report = f"""# UX æ·±åº¦åˆ†æå ±å‘Šï¼ˆLLM æ™ºèƒ½åˆ†æï¼‰

## ğŸ“‹ æ¸¬è©¦ä¿¡æ¯

| é …ç›® | å…§å®¹ |
|------|------|
| **æ¸¬è©¦ç›®éŒ„** | {test_metadata.get('run_directory', run_dir.name)} |
| **Persona æª”æ¡ˆ** | {test_metadata.get('persona_file', 'N/A')} |
| **Persona å§“å** | {test_metadata.get('persona_name', persona_info.get('name', 'N/A'))} |
| **Persona é¡å‹** | {test_metadata.get('persona_type', persona_info.get('type', 'N/A'))} |
| **åˆ†ææ™‚é–“** | {test_metadata.get('analysis_timestamp', datetime.now().isoformat())} |
| **ç¸½æ“ä½œæ¬¡æ•¸** | {test_metadata.get('total_actions', 'N/A')} |
| **ç¸½æ€è€ƒæ¬¡æ•¸** | {test_metadata.get('total_thoughts', 'N/A')} |
| **ç¸½åæ€æ¬¡æ•¸** | {test_metadata.get('total_reflections', 'N/A')} |
| **åˆ†ææ¨¡å‹** | GPT-4o |

---

## ğŸ“Š åŸ·è¡Œæ‘˜è¦

### ä»»å‹™å®Œæˆç‹€æ…‹
- **å®Œæˆ**: {'âœ… æ˜¯' if analysis.get('executive_summary', {}).get('task_completed') else 'âŒ å¦'}
- **åŸå› **: {analysis.get('executive_summary', {}).get('completion_reason', 'N/A')}

### é—œéµæ´å¯Ÿ
> {analysis.get('executive_summary', {}).get('key_insight', 'N/A')}

---

## ğŸ‘¤ Persona ç‰¹å¾µè©³æƒ…

- **å§“å**: {test_metadata.get('persona_name', persona_info.get('name', 'N/A'))}
- **é¡å‹**: {test_metadata.get('persona_type', persona_info.get('type', 'N/A'))}
- **é—œéµç‰¹å¾µ**:
  - é¢¨éšªæ„ŸçŸ¥: {test_metadata.get('risk_perception', persona_info.get('risk_perception', 'N/A'))}
  - è‡ªæˆ‘æ•ˆèƒ½: {test_metadata.get('self_efficacy', persona_info.get('self_efficacy', 'N/A'))}
  - å·¥ä½œè¨˜æ†¶: {test_metadata.get('working_memory', persona_info.get('working_memory', 'N/A'))}
  - ä»»å‹™ç­–ç•¥: {test_metadata.get('strategy', persona_info.get('strategy', 'N/A'))}

---

## ğŸ” è¡Œç‚ºæ¨¡å¼åˆ†æ

"""

    for i, pattern in enumerate(analysis.get('behavioral_patterns', []), 1):
        report += f"""
### æ¨¡å¼ {i}: {pattern.get('title', pattern.get('pattern', 'Unknown'))}

**è­‰æ“š**:
{pattern.get('evidence', 'N/A')}

**è§£è®€**:
{pattern.get('interpretation', 'N/A')}

---
"""

    report += """
## ğŸš¨ ç™¼ç¾çš„ UX å•é¡Œ

"""

    for i, issue in enumerate(analysis.get('ux_issues', []), 1):
        severity_emoji = {
            'CRITICAL': 'ğŸ”´',
            'HIGH': 'ğŸŸ ',
            'MEDIUM': 'ğŸŸ¡',
            'LOW': 'ğŸŸ¢'
        }.get(issue.get('severity', 'MEDIUM'), 'âšª')

        report += f"""
### {severity_emoji} å•é¡Œ {i}: {issue.get('title', 'Unknown')}

- **åš´é‡ç¨‹åº¦**: {issue.get('severity', 'N/A')}
- **é¡åˆ¥**: {issue.get('category', 'N/A')}

**æè¿°**:
{issue.get('description', 'N/A')}

**ä½¿ç”¨è€…å…§å¿ƒæƒ³æ³•**:
"""
        for thought in issue.get('user_thoughts', []):
            report += f'> "{thought}"\n\n'

        report += f"""
**å½±éŸ¿**:
{issue.get('impact', 'N/A')}

**è­‰æ“š**:
- é‡è¤‡å‹•ä½œ: {issue.get('evidence', {}).get('repeated_actions', 'N/A')}
- å›°æƒ‘è¨Šè™Ÿ: {issue.get('evidence', {}).get('confusion_signals', 'N/A')}

---
"""

    report += """
## ğŸ’¡ æ”¹å–„å»ºè­°

"""

    priority_order = {'P0 (ç«‹å³)': 1, 'P1 (çŸ­æœŸ)': 2, 'P2 (ä¸­æœŸ)': 3}
    recommendations = sorted(
        analysis.get('recommendations', []),
        key=lambda x: priority_order.get(x.get('priority', 'P2 (ä¸­æœŸ)'), 999)
    )

    for i, rec in enumerate(recommendations, 1):
        priority_emoji = {
            'P0 (ç«‹å³)': 'ğŸ”¥',
            'P1 (çŸ­æœŸ)': 'âš¡',
            'P2 (ä¸­æœŸ)': 'ğŸ“…'
        }.get(rec.get('priority', 'P2 (ä¸­æœŸ)'), 'ğŸ“Œ')

        report += f"""
### {priority_emoji} å»ºè­° {i}: {rec.get('title', 'Unknown')}

- **å„ªå…ˆç´š**: {rec.get('priority', 'N/A')}
- **é¡åˆ¥**: {rec.get('category', 'N/A')}
- **å¯¦æ–½é›£åº¦**: {rec.get('implementation_difficulty', 'N/A')}
- **æ‰€éœ€è³‡æº**: {rec.get('required_resources', 'N/A')}

**ç†ç”±**:
{rec.get('rationale', 'N/A')}

**å…·é«”è¡Œå‹•**:
"""
        for action in rec.get('specific_actions', []):
            report += f"- {action}\n"

        report += f"""
**é æœŸæ•ˆæœ**:
{rec.get('expected_impact', 'N/A')}

**Persona å°é½Š**:
{rec.get('persona_alignment', 'N/A')}

---
"""

    report += f"""
## ğŸ¯ Persona æ´å¯Ÿ

### é¢¨éšªæ„ŸçŸ¥é«”ç¾
{analysis.get('persona_insights', {}).get('risk_perception_manifestation', 'N/A')}

### è‡ªæˆ‘æ•ˆèƒ½å½±éŸ¿
{analysis.get('persona_insights', {}).get('self_efficacy_manifestation', 'N/A')}

### ä»»å‹™ç­–ç•¥æœ‰æ•ˆæ€§
{analysis.get('persona_insights', {}).get('strategy_effectiveness', 'N/A')}

### æœªè¢«æ»¿è¶³çš„éœ€æ±‚
"""
    for need in analysis.get('persona_insights', {}).get('unmet_needs', []):
        report += f"- {need}\n"

    if analysis.get('comparison_notes', {}).get('efficiency_vs_cautious'):
        report += f"""
---

## ğŸ“ˆ Persona é¡å‹å°æ¯”

{analysis['comparison_notes']['efficiency_vs_cautious']}
"""

    # æ–°å¢ï¼šUX æ”¹é€²è¡Œå‹•è¨ˆåŠƒ
    if 'action_plan' in analysis:
        report += """
---

## ğŸš€ UX æ”¹é€²è¡Œå‹•è¨ˆåŠƒ

æ­¤è¡Œå‹•è¨ˆåŠƒæ•´åˆäº†æ‰€æœ‰ UX å•é¡Œå’Œæ”¹å–„å»ºè­°ï¼ŒæŒ‰æ™‚é–“è»¸çµ„ç¹”æˆå¯åŸ·è¡Œçš„è¡Œå‹•é …ç›®ã€‚

"""
        action_plan = analysis['action_plan']

        # çŸ­æœŸè¡Œå‹•
        if 'short_term' in action_plan:
            short_term = action_plan['short_term']
            report += f"""
### ğŸ”¥ çŸ­æœŸè¡Œå‹•ï¼ˆ{short_term.get('timeframe', '1-2é€±å…§')}ï¼‰

**ç›®æ¨™**: {short_term.get('expected_impact', 'N/A')}

**è¡Œå‹•é …ç›®**:
"""
            for i, action in enumerate(short_term.get('actions', []), 1):
                quick_win_badge = ' ğŸ¯ Quick Win' if action.get('quick_win') else ''
                report += f"""
{i}. **{action.get('title', 'Unknown')}**{quick_win_badge}
   - å„ªå…ˆç´š: {action.get('priority', 'N/A')}
   - å¯¦æ–½é›£åº¦: {action.get('implementation_difficulty', 'N/A')}
   - æ‰€éœ€è³‡æº: {action.get('required_resources', 'N/A')}
   - åŸå› : {action.get('rationale', 'N/A')}
"""

            report += f"""
**æˆåŠŸæŒ‡æ¨™**:
"""
            for metric in short_term.get('success_metrics', []):
                report += f"- {metric}\n"

            report += f"""
**é¢¨éšªèˆ‡æŒ‘æˆ°**:
"""
            for risk in short_term.get('risks_and_challenges', []):
                report += f"- {risk}\n"

        # ä¸­æœŸè¡Œå‹•
        if 'mid_term' in action_plan:
            mid_term = action_plan['mid_term']
            report += f"""
---

### âš¡ ä¸­æœŸè¡Œå‹•ï¼ˆ{mid_term.get('timeframe', '1-2å€‹æœˆå…§')}ï¼‰

**ç›®æ¨™**: {mid_term.get('expected_impact', 'N/A')}

**è¡Œå‹•é …ç›®**:
"""
            for i, action in enumerate(mid_term.get('actions', []), 1):
                report += f"""
{i}. **{action.get('title', 'Unknown')}**
   - å„ªå…ˆç´š: {action.get('priority', 'N/A')}
   - å¯¦æ–½é›£åº¦: {action.get('implementation_difficulty', 'N/A')}
   - æ‰€éœ€è³‡æº: {action.get('required_resources', 'N/A')}
   - åŸå› : {action.get('rationale', 'N/A')}
"""

            report += f"""
**æˆåŠŸæŒ‡æ¨™**:
"""
            for metric in mid_term.get('success_metrics', []):
                report += f"- {metric}\n"

            report += f"""
**é¢¨éšªèˆ‡æŒ‘æˆ°**:
"""
            for risk in mid_term.get('risks_and_challenges', []):
                report += f"- {risk}\n"

        # é•·æœŸè¡Œå‹•
        if 'long_term' in action_plan:
            long_term = action_plan['long_term']
            report += f"""
---

### ğŸ“… é•·æœŸè¡Œå‹•ï¼ˆ{long_term.get('timeframe', '3-6å€‹æœˆå…§')}ï¼‰

**ç›®æ¨™**: {long_term.get('expected_impact', 'N/A')}

**è¡Œå‹•é …ç›®**:
"""
            for i, action in enumerate(long_term.get('actions', []), 1):
                report += f"""
{i}. **{action.get('title', 'Unknown')}**
   - å„ªå…ˆç´š: {action.get('priority', 'N/A')}
   - å¯¦æ–½é›£åº¦: {action.get('implementation_difficulty', 'N/A')}
   - æ‰€éœ€è³‡æº: {action.get('required_resources', 'N/A')}
   - åŸå› : {action.get('rationale', 'N/A')}
"""

            report += f"""
**æˆåŠŸæŒ‡æ¨™**:
"""
            for metric in long_term.get('success_metrics', []):
                report += f"- {metric}\n"

            report += f"""
**é¢¨éšªèˆ‡æŒ‘æˆ°**:
"""
            for risk in long_term.get('risks_and_challenges', []):
                report += f"- {risk}\n"

        # æ•´é«”å½±éŸ¿æ‘˜è¦
        if 'overall_impact_summary' in action_plan:
            report += f"""
---

### ğŸ“Š æ•´é«”å½±éŸ¿é ä¼°

{action_plan['overall_impact_summary']}

"""

        if 'persona_specific_note' in action_plan:
            report += f"""
**é‡å° {persona_info['name']} çš„ç‰¹åˆ¥èªªæ˜**:

{action_plan['persona_specific_note']}
"""

    report += f"""
---

**å ±å‘Šç”¢ç”Ÿæ™‚é–“**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
**åˆ†æå·¥å…·**: UX Analyzer LLM v2.0 (OpenAI GPT-4) - Enhanced with Action Plan
"""

    return report


def main():
    parser = argparse.ArgumentParser(description='ä½¿ç”¨ LLM æ™ºèƒ½åˆ†æ UX æ¸¬è©¦çµæœ')
    parser.add_argument('--run-dir', required=True, help='æ¸¬è©¦çµæœç›®éŒ„')
    parser.add_argument('--persona', required=True, help='Persona æª”æ¡ˆè·¯å¾‘')
    parser.add_argument('--api-key', help='OpenAI API keyï¼ˆæˆ–åœ¨ .env ä¸­è¨­å®š OPENAI_API_KEYï¼‰')
    parser.add_argument('--output', help='è¼¸å‡ºå ±å‘Šè·¯å¾‘ï¼ˆé è¨­: run-dir/ux_analysis_llm.mdï¼‰')

    args = parser.parse_args()

    run_dir = Path(args.run_dir)
    memory_trace_file = run_dir / 'memory_trace.json'
    action_trace_file = run_dir / 'action_trace.json'
    persona_file = Path(args.persona)

    # æª¢æŸ¥æª”æ¡ˆå­˜åœ¨
    if not memory_trace_file.exists():
        print(f"âŒ æ‰¾ä¸åˆ° memory_trace.json: {memory_trace_file}")
        return

    if not action_trace_file.exists():
        print(f"âŒ æ‰¾ä¸åˆ° action_trace.json: {action_trace_file}")
        return

    if not persona_file.exists():
        print(f"âŒ æ‰¾ä¸åˆ° persona æª”æ¡ˆ: {persona_file}")
        return

    print(f"ğŸ“Š é–‹å§‹ LLM æ™ºèƒ½åˆ†æ...")
    print(f"   æ¸¬è©¦ç›®éŒ„: {run_dir}")
    print(f"   Persona: {persona_file}")

    # è®€å–æ•¸æ“š
    with open(memory_trace_file, 'r', encoding='utf-8') as f:
        memory_trace = json.load(f)

    with open(action_trace_file, 'r', encoding='utf-8') as f:
        action_trace = json.load(f)

    persona_text = persona_file.read_text(encoding='utf-8')

    # è§£æ persona åŸºæœ¬è³‡è¨Š
    from ux_analyzer import PersonaProfile
    persona_profile = PersonaProfile(str(persona_file))
    persona_info = {
        'name': persona_profile.name,
        'type': persona_profile.persona_type,
        'risk_perception': persona_profile.risk_perception,
        'self_efficacy': persona_profile.self_efficacy,
        'working_memory': persona_profile.working_memory,
        'strategy': persona_profile.strategy
    }

    print(f"\nğŸ‘¤ Persona: {persona_info['name']} ({persona_info['type']})")

    # åˆå§‹åŒ– LLM åˆ†æå™¨
    try:
        analyzer = LLMUXAnalyzer(api_key=args.api_key)
    except ValueError as e:
        print(f"\nâŒ {e}")
        return

    # åŸ·è¡Œåˆ†æ
    try:
        analysis_result = analyzer.analyze_test_results(
            memory_trace=memory_trace,
            action_trace=action_trace,
            persona_text=persona_text,
            persona_info=persona_info,
            persona_file=persona_file.name,
            run_dir=run_dir.name
        )
    except Exception as e:
        print(f"\nâŒ åˆ†æå¤±æ•—: {e}")
        return

    # æª¢æŸ¥æ˜¯å¦æœ‰éŒ¯èª¤
    if 'error' in analysis_result:
        print(f"\nâŒ LLM åˆ†æå‡ºéŒ¯")
        print(f"éŒ¯èª¤: {analysis_result.get('error')}")
        print(f"\nåŸå§‹å›æ‡‰:\n{analysis_result.get('raw_response', '')[:1000]}...")
        return

    # å„²å­˜ JSON çµæœ
    json_output = args.output or str(run_dir / 'ux_analysis_llm.json')
    with open(json_output, 'w', encoding='utf-8') as f:
        json.dump(analysis_result, f, ensure_ascii=False, indent=2)
    print(f"âœ… JSON åˆ†æçµæœå·²å„²å­˜: {json_output}")

    # ç”¢ç”Ÿ Markdown å ±å‘Š
    md_output = str(run_dir / 'ux_analysis_llm.md')
    report = generate_markdown_report(analysis_result, persona_info, run_dir)
    Path(md_output).write_text(report, encoding='utf-8')
    print(f"âœ… Markdown å ±å‘Šå·²ç”¢ç”Ÿ: {md_output}")

    # é¡¯ç¤ºæ‘˜è¦
    print("\n" + "="*60)
    print("LLM åˆ†ææ‘˜è¦")
    print("="*60)

    summary = analysis_result.get('executive_summary', {})
    print(f"\nä»»å‹™å®Œæˆ: {'âœ… æ˜¯' if summary.get('task_completed') else 'âŒ å¦'}")
    print(f"åŸå› : {summary.get('completion_reason', 'N/A')}")
    print(f"\né—œéµæ´å¯Ÿ: {summary.get('key_insight', 'N/A')}")

    print(f"\nç™¼ç¾ {len(analysis_result.get('ux_issues', []))} å€‹ UX å•é¡Œ")
    print(f"ç”¢ç”Ÿ {len(analysis_result.get('recommendations', []))} é …æ”¹å–„å»ºè­°")

    print(f"\nğŸ“„ å®Œæ•´å ±å‘Šè«‹è¦‹: {md_output}")


if __name__ == '__main__':
    main()
